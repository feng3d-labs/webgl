{"version":3,"file":"bunny.html-NHqG0-ul.js","sources":["../../../../examples/src/regl-examples/bunny.ts"],"sourcesContent":["import { RenderObject, Submit } from '@feng3d/render-api';\nimport { WebGL } from '@feng3d/webgl';\n\nimport { reactive } from '@feng3d/reactivity';\nimport * as bunny from './mikolalysenko/bunny';\nimport * as mat4 from './stackgl/gl-mat4';\n\nconst canvas = document.createElement('canvas');\n\ncanvas.id = 'glcanvas';\ncanvas.width = window.innerWidth;\ncanvas.height = window.innerHeight;\ndocument.body.appendChild(canvas);\n\nconst webgl = new WebGL({ canvasId: 'glcanvas', webGLContextAttributes: { antialias: true } });\n\nconst positions = bunny.positions.reduce((pv: number[], cv: number[]) =>\n{\n    cv.forEach((v) =>\n    {\n        pv.push(v);\n    });\n\n    return pv;\n}, []);\n\nconst indices = bunny.cells.reduce((pv: number[], cv: number[]) =>\n{\n    cv.forEach((v) =>\n    {\n        pv.push(v);\n    });\n\n    return pv;\n}, []);\n\nlet tick = 0;\nlet viewportWidth = canvas.clientWidth;\nlet viewportHeight = canvas.clientHeight;\n\nconst renderObject: RenderObject = {\n    vertices: {\n        position: { data: new Float32Array(positions), format: 'float32x3' },\n    },\n    indices: new Uint16Array(indices),\n    draw: { __type__: 'DrawIndexed', indexCount: indices.length },\n    bindingResources: {\n        model: { value: mat4.identity([]) },\n    },\n    pipeline: {\n        vertex: {\n            code: `precision mediump float;\n        attribute vec3 position;\n        uniform mat4 model, view, projection;\n        void main() {\n          gl_Position = projection * view * model * vec4(position, 1);\n        }` },\n        fragment: {\n            code: `precision mediump float;\n        void main() {\n          gl_FragColor = vec4(1, 1, 1, 1);\n        }`,\n            targets: [{ blend: {} }],\n        },\n        depthStencil: {},\n    },\n};\n\nconst submit: Submit = {\n    commandEncoders: [{\n        passEncoders: [\n            {\n                descriptor: { colorAttachments: [{ clearValue: [0, 0, 0, 1] }], depthStencilAttachment: { depthClearValue: 1 } },\n                renderPassObjects: [renderObject],\n            },\n        ],\n    }],\n};\n\nfunction draw()\n{\n    viewportWidth = canvas.width = canvas.clientWidth;\n    viewportHeight = canvas.height = canvas.clientHeight;\n\n    tick++;\n    const t = 0.01 * tick;\n\n    reactive(renderObject.bindingResources).view = {\n        value: mat4.lookAt([],\n            [30 * Math.cos(t), 2.5, 30 * Math.sin(t)],\n            [0, 2.5, 0],\n            [0, 1, 0]),\n    };\n\n    reactive(renderObject.bindingResources).projection = {\n        value: mat4.perspective([],\n            Math.PI / 4,\n            viewportWidth / viewportHeight,\n            0.01,\n            1000),\n    };\n\n    webgl.submit(submit);\n\n    requestAnimationFrame(draw);\n}\ndraw();\n"],"names":["canvas","webgl","WebGL","positions","bunny.positions","pv","cv","v","indices","bunny.cells","tick","viewportWidth","viewportHeight","renderObject","mat4.identity","submit","draw","reactive","mat4.lookAt","mat4.perspective"],"mappings":"8MAOA,MAAMA,EAAS,SAAS,cAAc,QAAQ,EAE9CA,EAAO,GAAK,WACZA,EAAO,MAAQ,OAAO,WACtBA,EAAO,OAAS,OAAO,YACvB,SAAS,KAAK,YAAYA,CAAM,EAEhC,MAAMC,EAAQ,IAAIC,EAAM,CAAE,SAAU,WAAY,uBAAwB,CAAE,UAAW,EAAA,EAAQ,EAEvFC,EAAYC,EAAgB,OAAO,CAACC,EAAcC,KAEpDA,EAAG,QAASC,GACZ,CACIF,EAAG,KAAKE,CAAC,CACb,CAAC,EAEMF,GACR,EAAE,EAECG,EAAUC,EAAY,OAAO,CAACJ,EAAcC,KAE9CA,EAAG,QAASC,GACZ,CACIF,EAAG,KAAKE,CAAC,CACb,CAAC,EAEMF,GACR,EAAE,EAEL,IAAIK,EAAO,EACPC,EAAgBX,EAAO,YACvBY,EAAiBZ,EAAO,aAE5B,MAAMa,EAA6B,CAC/B,SAAU,CACN,SAAU,CAAE,KAAM,IAAI,aAAaV,CAAS,EAAG,OAAQ,WAAA,CAAY,EAEvE,QAAS,IAAI,YAAYK,CAAO,EAChC,KAAM,CAAE,SAAU,cAAe,WAAYA,EAAQ,MAAA,EACrD,iBAAkB,CACd,MAAO,CAAE,MAAOM,EAAc,EAAE,CAAA,CAAE,EAEtC,SAAU,CACN,OAAQ,CACJ,KAAM;AAAA;AAAA;AAAA;AAAA;AAAA,UAAA,EAMV,SAAU,CACN,KAAM;AAAA;AAAA;AAAA,WAIN,QAAS,CAAC,CAAE,MAAO,GAAI,CAAA,EAE3B,aAAc,CAAA,CAAC,CAEvB,EAEMC,EAAiB,CACnB,gBAAiB,CAAC,CACd,aAAc,CACV,CACI,WAAY,CAAE,iBAAkB,CAAC,CAAE,WAAY,CAAC,EAAG,EAAG,EAAG,CAAC,EAAG,EAAG,uBAAwB,CAAE,gBAAiB,EAAE,EAC7G,kBAAmB,CAACF,CAAY,CAAA,CACpC,CACJ,CACH,CACL,EAEA,SAASG,GACT,CACIL,EAAgBX,EAAO,MAAQA,EAAO,YACtCY,EAAiBZ,EAAO,OAASA,EAAO,aAExCU,IACA,MAAM,EAAI,IAAOA,EAEjBO,EAASJ,EAAa,gBAAgB,EAAE,KAAO,CAC3C,MAAOK,EAAY,CAAA,EACf,CAAC,GAAK,KAAK,IAAI,CAAC,EAAG,IAAK,GAAK,KAAK,IAAI,CAAC,CAAC,EACxC,CAAC,EAAG,IAAK,CAAC,EACV,CAAC,EAAG,EAAG,CAAC,CAAA,CAAC,EAGjBD,EAASJ,EAAa,gBAAgB,EAAE,WAAa,CACjD,MAAOM,EAAiB,CAAA,EACpB,KAAK,GAAK,EACVR,EAAgBC,EAChB,IACA,GAAA,CAAI,EAGZX,EAAM,OAAOc,CAAM,EAEnB,sBAAsBC,CAAI,CAC9B,CACAA,EAAA"}