{"version":3,"file":"texture_srgb.html-DC-q2Mrx.js","sources":["../../../../examples/src/WebGL2Samples/texture_srgb.ts"],"sourcesContent":["import { Buffer, CanvasContext, RenderPass, RenderPassObject, RenderPipeline, Sampler, Texture, VertexAttributes, VertexData } from '@feng3d/render-api';\nimport { WebGL } from '@feng3d/webgl';\n\nimport { getShaderSource, loadImage } from './utility';\n\n(function ()\n{\n    const canvas = document.createElement('canvas');\n\n    canvas.id = 'glcanvas';\n    canvas.width = Math.min(window.innerWidth, window.innerHeight);\n    canvas.height = canvas.width;\n    document.body.appendChild(canvas);\n\n    const rc: CanvasContext = { canvasId: 'glcanvas', webGLcontextId: 'webgl2', webGLContextAttributes: { antialias: false } };\n    const webgl = new WebGL(rc);\n\n    // -- Initialize program\n\n    const program: RenderPipeline = {\n        vertex: { code: getShaderSource('vs') }, fragment: { code: getShaderSource('fs') },\n    };\n\n    // -- Initialize buffer\n\n    const positions = new Float32Array([\n        -1.0, -1.0,\n        1.0, -1.0,\n        1.0, 1.0,\n        1.0, 1.0,\n        -1.0, 1.0,\n        -1.0, -1.0,\n    ]);\n    const vertexPosBuffer: VertexData = positions;\n\n    const texcoords = new Float32Array([\n        0.0, 1.0,\n        1.0, 1.0,\n        1.0, 0.0,\n        1.0, 0.0,\n        0.0, 0.0,\n        0.0, 1.0,\n    ]);\n    const vertexTexBuffer: VertexData = texcoords;\n\n    // -- Initialize vertex array\n\n    const vertices: VertexAttributes = {\n        position: { data: vertexPosBuffer, format: 'float32x2' },\n        textureCoordinates: { data: vertexTexBuffer, format: 'float32x2' },\n    };\n\n    // -- Load texture then render\n\n    const imageUrl = '../../assets/img/Di-3d.png';\n    let texture: Texture;\n    let sampler: Sampler;\n\n    loadImage(imageUrl, function (image)\n    {\n        texture = {\n            descriptor: {\n                size: [image.width, image.height],\n                format: 'rgba8unorm-srgb',\n            },\n            sources: [{ mipLevel: 0, image }],\n        };\n        sampler = { minFilter: 'nearest', magFilter: 'nearest' };\n\n        render();\n    });\n\n    function render()\n    {\n        const renderObjects: RenderPassObject[] = [];\n        // Clear color buffer\n        const rp: RenderPass = {\n            descriptor: { colorAttachments: [{ clearValue: [0.0, 0.0, 0.0, 1.0], loadOp: 'clear' }] },\n            renderPassObjects: renderObjects,\n        };\n\n        const matrix = new Float32Array([\n            0.5, 0.0, 0.0, 0.0,\n            0.0, 0.5, 0.0, 0.0,\n            0.0, 0.0, 0.5, 0.0,\n            0.0, 0.0, 0.0, 1.0,\n        ]);\n\n        renderObjects.push({\n            pipeline: program,\n            bindingResources: {\n                mvp: { value: matrix },\n                materialDiffuse: { texture, sampler },\n            },\n            vertices,\n            draw: { __type__: 'DrawVertex', vertexCount: 6 },\n        });\n\n        webgl.submit({ commandEncoders: [{ passEncoders: [rp] }] });\n\n        // Cleanup\n        webgl.deleteBuffer(Buffer.getBuffer(vertexPosBuffer.buffer));\n        webgl.deleteBuffer(Buffer.getBuffer(vertexTexBuffer.buffer));\n        webgl.deleteTexture(texture);\n        webgl.deleteProgram(program);\n    }\n})();\n"],"names":["canvas","rc","webgl","WebGL","program","getShaderSource","vertexPosBuffer","vertexTexBuffer","vertices","imageUrl","texture","sampler","loadImage","image","render","renderObjects","rp","matrix","Buffer"],"mappings":"0JAKC,UACD,CACI,MAAMA,EAAS,SAAS,cAAc,QAAQ,EAE9CA,EAAO,GAAK,WACZA,EAAO,MAAQ,KAAK,IAAI,OAAO,WAAY,OAAO,WAAW,EAC7DA,EAAO,OAASA,EAAO,MACvB,SAAS,KAAK,YAAYA,CAAM,EAEhC,MAAMC,EAAoB,CAAE,SAAU,WAAY,eAAgB,SAAU,uBAAwB,CAAE,UAAW,GAAM,EACjHC,EAAQ,IAAIC,EAAMF,CAAE,EAIpBG,EAA0B,CAC5B,OAAQ,CAAE,KAAMC,EAAgB,IAAI,CAAA,EAAK,SAAU,CAAE,KAAMA,EAAgB,IAAI,CAAA,CAAE,EAa/EC,EARY,IAAI,aAAa,CAC/B,GAAM,GACN,EAAK,GACL,EAAK,EACL,EAAK,EACL,GAAM,EACN,GAAM,EAAA,CACT,EAWKC,EARY,IAAI,aAAa,CAC/B,EAAK,EACL,EAAK,EACL,EAAK,EACL,EAAK,EACL,EAAK,EACL,EAAK,CAAA,CACR,EAKKC,EAA6B,CAC/B,SAAU,CAAE,KAAMF,EAAiB,OAAQ,WAAA,EAC3C,mBAAoB,CAAE,KAAMC,EAAiB,OAAQ,WAAA,CAAY,EAK/DE,EAAW,6BACjB,IAAIC,EACAC,EAEJC,EAAUH,EAAU,SAAUI,EAC9B,CACIH,EAAU,CACN,WAAY,CACR,KAAM,CAACG,EAAM,MAAOA,EAAM,MAAM,EAChC,OAAQ,iBAAA,EAEZ,QAAS,CAAC,CAAE,SAAU,EAAG,MAAAA,EAAO,CAAA,EAEpCF,EAAU,CAAE,UAAW,UAAW,UAAW,SAAA,EAE7CG,EAAA,CACJ,CAAC,EAED,SAASA,GACT,CACI,MAAMC,EAAoC,CAAA,EAEpCC,EAAiB,CACnB,WAAY,CAAE,iBAAkB,CAAC,CAAE,WAAY,CAAC,EAAK,EAAK,EAAK,CAAG,EAAG,OAAQ,OAAA,CAAS,CAAA,EACtF,kBAAmBD,CAAA,EAGjBE,EAAS,IAAI,aAAa,CAC5B,GAAK,EAAK,EAAK,EACf,EAAK,GAAK,EAAK,EACf,EAAK,EAAK,GAAK,EACf,EAAK,EAAK,EAAK,CAAA,CAClB,EAEDF,EAAc,KAAK,CACf,SAAUX,EACV,iBAAkB,CACd,IAAK,CAAE,MAAOa,CAAA,EACd,gBAAiB,CAAE,QAAAP,EAAS,QAAAC,CAAA,CAAQ,EAExC,SAAAH,EACA,KAAM,CAAE,SAAU,aAAc,YAAa,CAAA,CAAE,CAClD,EAEDN,EAAM,OAAO,CAAE,gBAAiB,CAAC,CAAE,aAAc,CAACc,CAAE,CAAA,CAAG,EAAG,EAG1Dd,EAAM,aAAagB,EAAO,UAAUZ,EAAgB,MAAM,CAAC,EAC3DJ,EAAM,aAAagB,EAAO,UAAUX,EAAgB,MAAM,CAAC,EAC3DL,EAAM,cAAcQ,CAAO,EAC3BR,EAAM,cAAcE,CAAO,CAC/B,CACJ,GAAA"}