import"../../modulepreload-polyfill-B5Qt9EMX.js";import{g as X,l as W}from"../../utility-BL6jGTgT.js";import{W as k,v as C}from"../../WebGL-lLSa4FVc.js";import{G as q}from"../../gltf-loader-CDzcHVJC.js";import{c as a,l as $,m as S,p as J,r as P,b as z,e as Z,d as K}from"../../mat4-BHCnbM9z.js";import{c as T,s as y}from"../../vec3-BLfYq55O.js";import"../../common-C8IKy_GC.js";(function(){const g={0:"point-list",3:"line-strip",2:"LINE_LOOP",1:"line-list",5:"triangle-strip",6:"TRIANGLE_FAN",4:"triangle-list"},c=Object.freeze({5126:"FLOAT",5120:"BYTE",5122:"SHORT",5121:"UNSIGNED_BYTE",5123:"UNSIGNED_SHORT",5131:"HALF_FLOAT",5124:"INT",5125:"UNSIGNED_INT",36255:"INT_2_10_10_10_REV",33640:"UNSIGNED_INT_2_10_10_10_REV"}),s=document.createElement("canvas");s.id="glcanvas",s.width=Math.min(window.innerWidth,window.innerHeight),s.height=s.width,document.body.appendChild(s);const v={canvasId:"glcanvas",webGLcontextId:"webgl2",webGLContextAttributes:{antialias:!1}},p=new k(v),B={vertex:{code:X("vs")},fragment:{code:X("fs")},depthStencil:{depthCompare:"less"}},h={};let l,i,I,A,N,w;const j=new q;let f;j.loadGLTF("../../assets/gltf/plane.gltf",function(e){f=e.scenes[e.defaultScene];let n,t;for(const o in f.meshes)for(l=f.meshes[o],h[o]=[],n=0,t=l.primitives.length;n<t;++n){i=l.primitives[n],I=i.vertexBuffer,A=i.indices;const _=i.attributes.POSITION,x=i.attributes.NORMAL,M=i.attributes.TEXCOORD_0;h[o].push({vertices:{position:{data:I,format:L(_.size,c[_.type]),arrayStride:_.stride,offset:_.offset},normal:{data:I,format:L(x.size,c[x.type]),arrayStride:x.stride,offset:x.offset},texcoord:{data:I,format:L(M.size,c[M.type]),arrayStride:M.stride,offset:M.offset}},indices:A})}W("../../assets/img/heightmap.jpg",function(o){N={descriptor:{format:"rgba8unorm",mipLevelCount:1,size:[256,256]},sources:[{image:o,flipY:!1}]},w={minFilter:"nearest",magFilter:"nearest",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},requestAnimationFrame(D)})});const d=[0,0,0],E=a(),H=a(),F=T();y(F,4,3,1);const G=T();y(G,0,.5,0);const V=T();y(V,0,1,0);const U=a();$(U,F,G,V);const r=a();S(r,U,H);const Y=a();J(Y,.785,1,1,1e3);let b=0,O=0;s.onmousedown=function(e){b=e.clientX,O=e.clientY},s.onmouseup=function(e){},s.onmousemove=function(e){const n=e.clientX,t=e.clientY,u=n-b,o=t-O,m=a();P(m,m,u/100),z(m,m,o/100),S(E,r,m),Z(r,E),b=n,O=t};const R=a();function D(){const e=[],n={descriptor:{colorAttachments:[{clearValue:[0,0,0,1],loadOp:"clear"}],depthStencilAttachment:{depthLoadOp:"clear"}},renderPassObjects:e};d[0]=2e-4,d[1]=1e-4,d[2]=5e-5,P(r,r,d[0]*Math.PI),z(r,r,d[1]*Math.PI),K(r,r,d[2]*Math.PI);let t,u;for(const o in f.meshes)for(l=f.meshes[o],t=0,u=l.primitives.length;t<u;++t)i=l.primitives[t],S(R,r,i.matrix),e.push({pipeline:{...B,primitive:{topology:g[i.mode]}},bindingResources:{mvMatrix:{value:R},pMatrix:{value:Y},displacementMap:{texture:N,sampler:w},diffuse:{texture:N,sampler:w}},vertices:h[o][t].vertices,indices:h[o][t].indices,draw:{__type__:"DrawIndexed",indexCount:i.indices.length}});p.submit({commandEncoders:[{passEncoders:[n]}]}),requestAnimationFrame(D)}})();function L(g,c="FLOAT",s=!1){for(const v in C){const p=C[v];if(p.numComponents===g&&p.type===c&&!p.normalized==!s)return v}console.error(`没有找到与 ${JSON.stringify({numComponents:g,type:c,normalized:s})} 对应的顶点数据格式！`)}
//# sourceMappingURL=texture_vertex.html-B_B1w2MV.js.map
