{"version":3,"file":"fbo_rtt_draw_buffers.html-BvhwnkHH.js","sources":["../../../../examples/src/WebGL2Samples/fbo_rtt_draw_buffers.ts"],"sourcesContent":["import { CanvasContext, RenderPass, RenderPassDescriptor, RenderPipeline, Sampler, Texture, VertexAttributes } from '@feng3d/render-api';\nimport { WebGL } from '@feng3d/webgl';\nimport { getShaderSource } from './utility';\n\nconst canvas = document.createElement('canvas');\n\ncanvas.id = 'glcanvas';\ncanvas.width = window.innerWidth;\ncanvas.height = window.innerHeight;\ndocument.body.appendChild(canvas);\n\nconst renderingContext: CanvasContext = { canvasId: 'glcanvas' };\nconst webgl = new WebGL(renderingContext);\n\nconst windowSize = {\n    x: canvas.width,\n    y: canvas.height,\n};\n\n// -- Initialize program\n\n// Draw buffer shaders\nconst drawBufferProgram: RenderPipeline = {\n    vertex: { code: getShaderSource('vs-draw-buffer') },\n    fragment: { code: getShaderSource('fs-draw-buffer') },\n    primitive: { topology: 'triangle-list' },\n};\n\n// Draw shaders\nconst drawProgram: RenderPipeline = {\n    vertex: { code: getShaderSource('vs-draw') },\n    fragment: { code: getShaderSource('fs-draw') },\n    primitive: { topology: 'triangle-list' },\n};\n\n// -- Initialize buffer\n\nconst triPositions = new Float32Array([\n    -0.5, -0.5, -1.0,\n    0.5, -0.5, -1.0,\n    0.0, 0.5, 1.0,\n]);\n\nconst quadPositions = new Float32Array([\n    -1.0, -1.0,\n    1.0, -1.0,\n    1.0, 1.0,\n    1.0, 1.0,\n    -1.0, 1.0,\n    -1.0, -1.0,\n]);\n\nconst quadTexcoords = new Float32Array([\n    0.0, 0.0,\n    1.0, 0.0,\n    1.0, 1.0,\n    1.0, 1.0,\n    0.0, 1.0,\n    0.0, 0.0,\n]);\n\n// -- Initialize vertex array\n\nconst triVertexArray: { vertices?: VertexAttributes } = {\n    vertices: {\n        position: { data: triPositions, format: 'float32x3' },\n    },\n};\n\nconst quadVertexArray: { vertices?: VertexAttributes } = {\n    vertices: {\n        position: { data: quadPositions, format: 'float32x2' },\n        textureCoordinates: { data: quadTexcoords, format: 'float32x2' },\n    },\n};\n\n// -- Initialize texture targets\n\nconst color1Texture: Texture = {\n    descriptor: {\n        format: 'rgba8unorm',\n        size: [windowSize.x, windowSize.y],\n    },\n};\nconst color1Sampler: Sampler = { addressModeU: 'clamp-to-edge', addressModeV: 'clamp-to-edge', minFilter: 'nearest', magFilter: 'nearest' };\n\nconst color2Texture: Texture = {\n    descriptor: {\n        format: 'rgba8unorm',\n        size: [windowSize.x, windowSize.y],\n    },\n};\nconst color2Sampler: Sampler = { addressModeU: 'clamp-to-edge', addressModeV: 'clamp-to-edge', minFilter: 'nearest', magFilter: 'nearest' };\n\n// -- Initialize frame buffer\n\nconst frameBuffer: RenderPassDescriptor = {\n    colorAttachments: [\n        { view: { texture: color1Texture, baseMipLevel: 0 } },\n        { view: { texture: color2Texture, baseMipLevel: 0 } },\n    ],\n};\n\n// -- Render\n\nconst renderPass: RenderPass = {\n    descriptor: frameBuffer,\n    renderPassObjects: [{\n        pipeline: drawBufferProgram,\n        vertices: triVertexArray.vertices,\n        draw: { __type__: 'DrawVertex', vertexCount: 3 },\n    }],\n};\n\n// Pass 2: Draw to screen\nconst renderPass2: RenderPass = {\n    descriptor: { colorAttachments: [{ clearValue: [0.0, 0.0, 0.0, 1.0], loadOp: 'clear' }] },\n    renderPassObjects: [{\n        pipeline: drawProgram,\n        bindingResources: {\n            color1Map: { texture: color1Texture, sampler: color1Sampler },\n            color2Map: { texture: color2Texture, sampler: color2Sampler },\n        },\n        vertices: quadVertexArray.vertices,\n        draw: { __type__: 'DrawVertex', vertexCount: 6 },\n    }],\n};\n\nwebgl.submit({ commandEncoders: [{ passEncoders: [renderPass, renderPass2] }] });\n\n// Clean up\nwebgl.deleteFramebuffer(frameBuffer);\nwebgl.deleteTexture(color1Texture);\nwebgl.deleteTexture(color2Texture);\nwebgl.deleteProgram(drawBufferProgram);\nwebgl.deleteProgram(drawProgram);\n\n"],"names":["canvas","renderingContext","webgl","WebGL","windowSize","drawBufferProgram","getShaderSource","drawProgram","triPositions","quadPositions","quadTexcoords","triVertexArray","quadVertexArray","color1Texture","color1Sampler","color2Texture","color2Sampler","frameBuffer","renderPass","renderPass2"],"mappings":"2IAIA,MAAMA,EAAS,SAAS,cAAc,QAAQ,EAE9CA,EAAO,GAAK,WACZA,EAAO,MAAQ,OAAO,WACtBA,EAAO,OAAS,OAAO,YACvB,SAAS,KAAK,YAAYA,CAAM,EAEhC,MAAMC,EAAkC,CAAE,SAAU,UAAA,EAC9CC,EAAQ,IAAIC,EAAMF,CAAgB,EAElCG,EAAa,CACf,EAAGJ,EAAO,MACV,EAAGA,EAAO,MACd,EAKMK,EAAoC,CACtC,OAAQ,CAAE,KAAMC,EAAgB,gBAAgB,CAAA,EAChD,SAAU,CAAE,KAAMA,EAAgB,gBAAgB,CAAA,EAClD,UAAW,CAAE,SAAU,eAAA,CAC3B,EAGMC,EAA8B,CAChC,OAAQ,CAAE,KAAMD,EAAgB,SAAS,CAAA,EACzC,SAAU,CAAE,KAAMA,EAAgB,SAAS,CAAA,EAC3C,UAAW,CAAE,SAAU,eAAA,CAC3B,EAIME,EAAe,IAAI,aAAa,CAClC,IAAM,IAAM,GACZ,GAAK,IAAM,GACX,EAAK,GAAK,CACd,CAAC,EAEKC,EAAgB,IAAI,aAAa,CACnC,GAAM,GACN,EAAK,GACL,EAAK,EACL,EAAK,EACL,GAAM,EACN,GAAM,EACV,CAAC,EAEKC,EAAgB,IAAI,aAAa,CACnC,EAAK,EACL,EAAK,EACL,EAAK,EACL,EAAK,EACL,EAAK,EACL,EAAK,CACT,CAAC,EAIKC,EAAkD,CACpD,SAAU,CACN,SAAU,CAAE,KAAMH,EAAc,OAAQ,WAAA,CAAY,CAE5D,EAEMI,EAAmD,CACrD,SAAU,CACN,SAAU,CAAE,KAAMH,EAAe,OAAQ,WAAA,EACzC,mBAAoB,CAAE,KAAMC,EAAe,OAAQ,WAAA,CAAY,CAEvE,EAIMG,EAAyB,CAC3B,WAAY,CACR,OAAQ,aACR,KAAM,CAACT,EAAW,EAAGA,EAAW,CAAC,CAAA,CAEzC,EACMU,EAAyB,CAAE,aAAc,gBAAiB,aAAc,gBAAiB,UAAW,UAAW,UAAW,SAAA,EAE1HC,EAAyB,CAC3B,WAAY,CACR,OAAQ,aACR,KAAM,CAACX,EAAW,EAAGA,EAAW,CAAC,CAAA,CAEzC,EACMY,EAAyB,CAAE,aAAc,gBAAiB,aAAc,gBAAiB,UAAW,UAAW,UAAW,SAAA,EAI1HC,EAAoC,CACtC,iBAAkB,CACd,CAAE,KAAM,CAAE,QAASJ,EAAe,aAAc,EAAE,EAClD,CAAE,KAAM,CAAE,QAASE,EAAe,aAAc,EAAE,CAAE,CAE5D,EAIMG,EAAyB,CAC3B,WAAYD,EACZ,kBAAmB,CAAC,CAChB,SAAUZ,EACV,SAAUM,EAAe,SACzB,KAAM,CAAE,SAAU,aAAc,YAAa,CAAA,CAAE,CAClD,CACL,EAGMQ,EAA0B,CAC5B,WAAY,CAAE,iBAAkB,CAAC,CAAE,WAAY,CAAC,EAAK,EAAK,EAAK,CAAG,EAAG,OAAQ,OAAA,CAAS,CAAA,EACtF,kBAAmB,CAAC,CAChB,SAAUZ,EACV,iBAAkB,CACd,UAAW,CAAE,QAASM,EAAe,QAASC,CAAA,EAC9C,UAAW,CAAE,QAASC,EAAe,QAASC,CAAA,CAAc,EAEhE,SAAUJ,EAAgB,SAC1B,KAAM,CAAE,SAAU,aAAc,YAAa,CAAA,CAAE,CAClD,CACL,EAEAV,EAAM,OAAO,CAAE,gBAAiB,CAAC,CAAE,aAAc,CAACgB,EAAYC,CAAW,CAAA,CAAG,EAAG,EAG/EjB,EAAM,kBAAkBe,CAAW,EACnCf,EAAM,cAAcW,CAAa,EACjCX,EAAM,cAAca,CAAa,EACjCb,EAAM,cAAcG,CAAiB,EACrCH,EAAM,cAAcK,CAAW"}