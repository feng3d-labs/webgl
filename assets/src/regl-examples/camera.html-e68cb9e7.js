import"../../modulepreload-polyfill-3cfb730f.js";import{W as N}from"../../WebGL-b4686ab5.js";import{p as W,c as Y}from"../../bunny-ceb2d3cd.js";import{i as R,l as O,p as U}from"../../gl-mat4-3d6487f1.js";function K(t,e,i){return Math.sqrt(Math.pow(t,2)+Math.pow(e,2)+Math.pow(i,2))}function X(t,e,i){return Math.atan2(e,t-i)}function k(t,e,i,w,d){t[0]+=e*i,t[1]+=e*w,t[2]+=e*d}function $(t,e){const i=e.length,w=t.length,d=new Array(i);for(let o=0;o<i;++o)d[o]=[0,0,0];for(let o=0;o<w;++o){const r=t[o],c=e[r[0]],f=e[r[1]],l=e[r[2]],m=c[0]-f[0],h=c[1]-f[1],E=c[2]-f[2],L=K(m,h,E),x=f[0]-l[0],g=f[1]-l[1],u=f[2]-l[2],a=K(x,g,u),n=l[0]-c[0],s=l[1]-c[1],v=l[2]-c[2],p=K(n,s,v);if(Math.min(L,a,p)<1e-6)continue;const M=.5*(L+a+p),j=Math.sqrt((M-L)*(M-a)*(M-p)/M);let A=h*u-E*g,y=E*x-m*u,C=m*g-h*x;const D=K(A,y,C);A/=D,y/=D,C/=D,k(d[r[0]],X(M,j,a),A,y,C),k(d[r[1]],X(M,j,p),A,y,C),k(d[r[2]],X(M,j,L),A,y,C)}for(let o=0;o<i;++o){const r=d[o],c=Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)+Math.pow(r[2],2));if(c<1e-8){r[0]=1,r[1]=0,r[2]=0;continue}r[0]/=c,r[1]/=c,r[2]/=c}return d}function B(t){if(typeof t=="object"){if("buttons"in t)return t.buttons;if("which"in t){const e=t.which;if(e===2)return 4;if(e===3)return 2;if(e>0)return 1<<e-1}else if("button"in t){const e=t.button;if(e===1)return 4;if(e===2)return 2;if(e>=0)return 1<<e}}return 0}const P=B;function z(t){return t.target||t.srcElement||window}function G(t){if(typeof t=="object"){if("offsetX"in t)return t.offsetX;const i=z(t).getBoundingClientRect();return t.clientX-i.left}return 0}const V=G;function Z(t){if(typeof t=="object"){if("offsetY"in t)return t.offsetY;const i=z(t).getBoundingClientRect();return t.clientY-i.top}return 0}const J=Z;function Q(t,e){e||(e=t,t=window);let i=0,w=0,d=0;const o={shift:!1,alt:!1,control:!1,meta:!1};let r=!1;function c(n){let s=!1;return"altKey"in n&&(s=s||n.altKey!==o.alt,o.alt=!!n.altKey),"shiftKey"in n&&(s=s||n.shiftKey!==o.shift,o.shift=!!n.shiftKey),"ctrlKey"in n&&(s=s||n.ctrlKey!==o.control,o.control=!!n.ctrlKey),"metaKey"in n&&(s=s||n.metaKey!==o.meta,o.meta=!!n.metaKey),s}function f(n,s){const v=V(s),p=J(s);"buttons"in s&&(n=s.buttons|0),(n!==i||v!==w||p!==d||c(s))&&(i=n|0,w=v||0,d=p||0,e&&e(i,w,d,o))}function l(n){f(0,n)}function m(){(i||w||d||o.shift||o.alt||o.meta||o.control)&&(w=d=0,i=0,o.shift=o.alt=o.control=o.meta=!1,e&&e(0,0,0,o))}function h(n){c(n)&&e&&e(i,w,d,o)}function E(n){P(n)===0?f(0,n):f(i,n)}function L(n){f(i|P(n),n)}function x(n){f(i&~P(n),n)}function g(){r||(r=!0,t.addEventListener("mousemove",E),t.addEventListener("mousedown",L),t.addEventListener("mouseup",x),t.addEventListener("mouseleave",l),t.addEventListener("mouseenter",l),t.addEventListener("mouseout",l),t.addEventListener("mouseover",l),t.addEventListener("blur",m),t.addEventListener("keyup",h),t.addEventListener("keydown",h),t.addEventListener("keypress",h),t!==window&&(window.addEventListener("blur",m),window.addEventListener("keyup",h),window.addEventListener("keydown",h),window.addEventListener("keypress",h)))}function u(){r&&(r=!1,t.removeEventListener("mousemove",E),t.removeEventListener("mousedown",L),t.removeEventListener("mouseup",x),t.removeEventListener("mouseleave",l),t.removeEventListener("mouseenter",l),t.removeEventListener("mouseout",l),t.removeEventListener("mouseover",l),t.removeEventListener("blur",m),t.removeEventListener("keyup",h),t.removeEventListener("keydown",h),t.removeEventListener("keypress",h),t!==window&&(window.removeEventListener("blur",m),window.removeEventListener("keyup",h),window.removeEventListener("keydown",h),window.removeEventListener("keypress",h)))}g();const a={element:t};return Object.defineProperties(a,{enabled:{get(){return r},set(n){n?g():u()},enumerable:!0},buttons:{get(){return i},enumerable:!0},x:{get(){return w},enumerable:!0},y:{get(){return d},enumerable:!0},mods:{get(){return o},enumerable:!0}}),a}function T(t,e){e||(e=[0,""]),t=String(t);const i=parseFloat(t);return e[0]=i,e[1]=t.match(/[\d.\-\+]*\s*(.*)/)[1]||"",e}const F=96,_={ch:8,ex:7.15625,em:16,rem:16,in:F,cm:F/2.54,mm:F/25.4,pt:F/72,pc:F/6,px:1};function S(t){if(!t)return null;if(_[t])return _[t];const e=T(t);if(!isNaN(e[0])&&e[1]){const i=S(e[1]);return typeof i=="number"?e[0]*i:null}return null}function tt(t,e,i){typeof t=="function"&&(i=!!e,e=t,t=window);const w=S("ex"),d=o=>{i&&o.preventDefault();let r=o.deltaX||0,c=o.deltaY||0,f=o.deltaZ||0;const l=o.deltaMode;let m=1;switch(l){case 1:m=w;break;case 2:m=window.innerHeight;break}if(r*=m,c*=m,f*=m,r||c||f)return e(r,c,f,o)};return t.addEventListener("wheel",d),d}function et(t){const e={view:R(new Float32Array(16)),projection:R(new Float32Array(16)),center:new Float32Array(t.center||3),theta:t.theta||0,phi:t.phi||0,distance:Math.log(t.distance||10),eye:new Float32Array(3),up:new Float32Array(t.up||[0,1,0])},i=new Float32Array([1,0,0]),w=new Float32Array([0,0,1]),d=Math.log("minDistance"in t?t.minDistance:.1),o=Math.log("maxDistance"in t?t.maxDistance:1e3);let r=0,c=0,f=0,l=0,m=0;Q(function(u,a,n){if(u&1){const s=(a-l)/window.innerWidth,v=(n-m)/window.innerHeight,p=Math.max(e.distance,.5);r+=p*s,c+=p*v}l=a,m=n}),tt(function(u,a){f+=a/window.innerHeight});function h(u){const a=u*.9;return Math.abs(a)<.1?0:a}function E(u,a,n){return Math.min(Math.max(u,a),n)}function L(){const u=e.center,a=e.eye,n=e.up;e.theta+=r,e.phi=E(e.phi+c,-Math.PI/2,Math.PI/2),e.distance=E(e.distance+f,d,o),r=h(r),c=h(c),f=h(f);const s=e.theta,v=e.phi,p=Math.exp(e.distance),M=p*Math.sin(s)*Math.cos(v),j=p*Math.cos(s)*Math.cos(v),A=p*Math.sin(v);for(let y=0;y<3;++y)a[y]=u[y]+M*w[y]+j*i[y]+A*n[y];O(e.view,a,u,n)}const x=(u,a,n)=>{Object.keys(e).forEach(function(s){u.bindingResources[s]=g[s]}),u.bindingResources.projection=U(e.projection,Math.PI/4,a/n,.01,1e3)};function g(u,a,n){L(),x(u,a,n)}return Object.keys(e).forEach(function(u){g[u]=e[u]}),g}const b=document.createElement("canvas");b.id="glcanvas";b.width=window.innerWidth;b.height=window.innerHeight;document.body.appendChild(b);const nt=new N({canvasId:"glcanvas",webGLContextAttributes:{antialias:!0}}),ot=et({center:[0,2.5,0]}),it=W.flat(),H=Y.flat(),rt=$(Y,W).flat(),I={geometry:{vertices:{position:{data:new Float32Array(it),format:"float32x3"},normal:{data:new Float32Array(rt),format:"float32x3"}},indices:new Uint16Array(H),draw:{__type__:"DrawIndexed",indexCount:H.length}},bindingResources:{},pipeline:{vertex:{code:`precision mediump float;
        uniform mat4 projection, view;
        attribute vec3 position, normal;
        varying vec3 vnormal;
        void main () {
          vnormal = normal;
          gl_Position = projection * view * vec4(position, 1.0);
        }`},fragment:{code:`precision mediump float;
        varying vec3 vnormal;
        void main () {
          gl_FragColor = vec4(abs(vnormal), 1.0);
        }`,targets:[{blend:{}}]},depthStencil:{depthWriteEnabled:!0}}};function q(){b.width=b.clientWidth,b.height=b.clientHeight,ot(I,b.width,b.height),nt.submit({commandEncoders:[{passEncoders:[{descriptor:{colorAttachments:[{clearValue:[0,0,0,1]}]},renderObjects:[I]}]}]}),requestAnimationFrame(q)}q();
//# sourceMappingURL=camera.html-e68cb9e7.js.map
