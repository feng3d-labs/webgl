{"version":3,"file":"camera.html-e68cb9e7.js","sources":["../../../../examples/src/regl-examples/mikolalysenko/angle-normals.ts","../../../../examples/src/regl-examples/mikolalysenko/mouse-event.ts","../../../../examples/src/regl-examples/mikolalysenko/mouse-change.ts","../../../../examples/src/regl-examples/mikolalysenko/parse-unit.ts","../../../../examples/src/regl-examples/mikolalysenko/to-px.ts","../../../../examples/src/regl-examples/mikolalysenko/mouse-wheel.ts","../../../../examples/src/regl-examples/util/camera.ts","../../../../examples/src/regl-examples/camera.ts"],"sourcesContent":["function hypot(x, y, z)\n{\n    return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2) + Math.pow(z, 2));\n}\n\nfunction weight(s, r, a)\n{\n    return Math.atan2(r, (s - a));\n}\n\nfunction mulAdd(dest, s, x, y, z)\n{\n    dest[0] += s * x;\n    dest[1] += s * y;\n    dest[2] += s * z;\n}\n\nexport function angleNormals(cells: number[][], positions: number[][])\n{\n    const numVerts = positions.length;\n    const numCells = cells.length;\n\n    // Allocate normal array\n    const normals: number[][] = new Array(numVerts);\n    for (let i = 0; i < numVerts; ++i)\n    {\n        normals[i] = [0, 0, 0];\n    }\n\n    // Scan cells, and\n    for (let i = 0; i < numCells; ++i)\n    {\n        const cell = cells[i];\n        const a = positions[cell[0]];\n        const b = positions[cell[1]];\n        const c = positions[cell[2]];\n\n        const abx = a[0] - b[0];\n        const aby = a[1] - b[1];\n        const abz = a[2] - b[2];\n        const ab = hypot(abx, aby, abz);\n\n        const bcx = b[0] - c[0];\n        const bcy = b[1] - c[1];\n        const bcz = b[2] - c[2];\n        const bc = hypot(bcx, bcy, bcz);\n\n        const cax = c[0] - a[0];\n        const cay = c[1] - a[1];\n        const caz = c[2] - a[2];\n        const ca = hypot(cax, cay, caz);\n\n        if (Math.min(ab, bc, ca) < 1e-6)\n        {\n            continue;\n        }\n\n        const s = 0.5 * (ab + bc + ca);\n        const r = Math.sqrt((s - ab) * (s - bc) * (s - ca) / s);\n\n        let nx = aby * bcz - abz * bcy;\n        let ny = abz * bcx - abx * bcz;\n        let nz = abx * bcy - aby * bcx;\n        const nl = hypot(nx, ny, nz);\n        nx /= nl;\n        ny /= nl;\n        nz /= nl;\n\n        mulAdd(normals[cell[0]], weight(s, r, bc), nx, ny, nz);\n        mulAdd(normals[cell[1]], weight(s, r, ca), nx, ny, nz);\n        mulAdd(normals[cell[2]], weight(s, r, ab), nx, ny, nz);\n    }\n\n    // Normalize all the normals\n    for (let i = 0; i < numVerts; ++i)\n    {\n        const n = normals[i];\n        const l = Math.sqrt(\n            Math.pow(n[0], 2)\n            + Math.pow(n[1], 2)\n            + Math.pow(n[2], 2));\n        if (l < 1e-8)\n        {\n            n[0] = 1;\n            n[1] = 0;\n            n[2] = 0;\n            continue;\n        }\n        n[0] /= l;\n        n[1] /= l;\n        n[2] /= l;\n    }\n\n    return normals;\n}\n","// @see https://github.com/mikolalysenko/mouse-event.git\n\nfunction mouseButtons(ev)\n{\n    if (typeof ev === \"object\")\n    {\n        if (\"buttons\" in ev)\n        {\n            return ev.buttons;\n        }\n        else if (\"which\" in ev)\n        {\n            const b = ev.which;\n            if (b === 2)\n            {\n                return 4;\n            }\n            else if (b === 3)\n            {\n                return 2;\n            }\n            else if (b > 0)\n            {\n                return 1 << (b - 1);\n            }\n        }\n        else if (\"button\" in ev)\n        {\n            const b = ev.button;\n            if (b === 1)\n            {\n                return 4;\n            }\n            else if (b === 2)\n            {\n                return 2;\n            }\n            else if (b >= 0)\n            {\n                return 1 << b;\n            }\n        }\n    }\n\n    return 0;\n}\nexport const buttons = mouseButtons;\n\nfunction mouseElement(ev)\n{\n    return ev.target || ev.srcElement || window;\n}\nexport const element = mouseElement;\n\nfunction mouseRelativeX(ev)\n{\n    if (typeof ev === \"object\")\n    {\n        if (\"offsetX\" in ev)\n        {\n            return ev.offsetX;\n        }\n        const target = mouseElement(ev);\n        const bounds = target.getBoundingClientRect();\n\n        return ev.clientX - bounds.left;\n    }\n\n    return 0;\n}\nexport const x = mouseRelativeX;\n\nfunction mouseRelativeY(ev)\n{\n    if (typeof ev === \"object\")\n    {\n        if (\"offsetY\" in ev)\n        {\n            return ev.offsetY;\n        }\n        const target = mouseElement(ev);\n        const bounds = target.getBoundingClientRect();\n\n        return ev.clientY - bounds.top;\n    }\n\n    return 0;\n}\nexport const y = mouseRelativeY;\n","// @see https://github.com/mikolalysenko/mouse-change.git\n\nimport * as mouse from \"./mouse-event\";\n\nexport function mouseListen(element?, callback?)\n{\n    if (!callback)\n    {\n        callback = element;\n        element = window;\n    }\n\n    let buttonState = 0;\n    let x = 0;\n    let y = 0;\n    const mods = {\n        shift: false,\n        alt: false,\n        control: false,\n        meta: false\n    };\n    let attached = false;\n\n    function updateMods(ev)\n    {\n        let changed = false;\n        if (\"altKey\" in ev)\n        {\n            changed = changed || ev.altKey !== mods.alt;\n            mods.alt = !!ev.altKey;\n        }\n        if (\"shiftKey\" in ev)\n        {\n            changed = changed || ev.shiftKey !== mods.shift;\n            mods.shift = !!ev.shiftKey;\n        }\n        if (\"ctrlKey\" in ev)\n        {\n            changed = changed || ev.ctrlKey !== mods.control;\n            mods.control = !!ev.ctrlKey;\n        }\n        if (\"metaKey\" in ev)\n        {\n            changed = changed || ev.metaKey !== mods.meta;\n            mods.meta = !!ev.metaKey;\n        }\n\n        return changed;\n    }\n\n    function handleEvent(nextButtons, ev)\n    {\n        const nextX = mouse.x(ev);\n        const nextY = mouse.y(ev);\n        if (\"buttons\" in ev)\n        {\n            nextButtons = ev.buttons | 0;\n        }\n        if (nextButtons !== buttonState\n            || nextX !== x\n            || nextY !== y\n            || updateMods(ev))\n        {\n            buttonState = nextButtons | 0;\n            x = nextX || 0;\n            y = nextY || 0;\n            callback && callback(buttonState, x, y, mods);\n        }\n    }\n\n    function clearState(ev)\n    {\n        handleEvent(0, ev);\n    }\n\n    function handleBlur()\n    {\n        if (buttonState\n            || x\n            || y\n            || mods.shift\n            || mods.alt\n            || mods.meta\n            || mods.control)\n        {\n            x = y = 0;\n            buttonState = 0;\n            mods.shift = mods.alt = mods.control = mods.meta = false;\n            callback && callback(0, 0, 0, mods);\n        }\n    }\n\n    function handleMods(ev)\n    {\n        if (updateMods(ev))\n        {\n            callback && callback(buttonState, x, y, mods);\n        }\n    }\n\n    function handleMouseMove(ev)\n    {\n        if (mouse.buttons(ev) === 0)\n        {\n            handleEvent(0, ev);\n        }\n        else\n        {\n            handleEvent(buttonState, ev);\n        }\n    }\n\n    function handleMouseDown(ev)\n    {\n        handleEvent(buttonState | mouse.buttons(ev), ev);\n    }\n\n    function handleMouseUp(ev)\n    {\n        handleEvent(buttonState & ~mouse.buttons(ev), ev);\n    }\n\n    function attachListeners()\n    {\n        if (attached)\n        {\n            return;\n        }\n        attached = true;\n\n        element.addEventListener(\"mousemove\", handleMouseMove);\n\n        element.addEventListener(\"mousedown\", handleMouseDown);\n\n        element.addEventListener(\"mouseup\", handleMouseUp);\n\n        element.addEventListener(\"mouseleave\", clearState);\n        element.addEventListener(\"mouseenter\", clearState);\n        element.addEventListener(\"mouseout\", clearState);\n        element.addEventListener(\"mouseover\", clearState);\n\n        element.addEventListener(\"blur\", handleBlur);\n\n        element.addEventListener(\"keyup\", handleMods);\n        element.addEventListener(\"keydown\", handleMods);\n        element.addEventListener(\"keypress\", handleMods);\n\n        if (element !== window)\n        {\n            window.addEventListener(\"blur\", handleBlur);\n\n            window.addEventListener(\"keyup\", handleMods);\n            window.addEventListener(\"keydown\", handleMods);\n            window.addEventListener(\"keypress\", handleMods);\n        }\n    }\n\n    function detachListeners()\n    {\n        if (!attached)\n        {\n            return;\n        }\n        attached = false;\n\n        element.removeEventListener(\"mousemove\", handleMouseMove);\n\n        element.removeEventListener(\"mousedown\", handleMouseDown);\n\n        element.removeEventListener(\"mouseup\", handleMouseUp);\n\n        element.removeEventListener(\"mouseleave\", clearState);\n        element.removeEventListener(\"mouseenter\", clearState);\n        element.removeEventListener(\"mouseout\", clearState);\n        element.removeEventListener(\"mouseover\", clearState);\n\n        element.removeEventListener(\"blur\", handleBlur);\n\n        element.removeEventListener(\"keyup\", handleMods);\n        element.removeEventListener(\"keydown\", handleMods);\n        element.removeEventListener(\"keypress\", handleMods);\n\n        if (element !== window)\n        {\n            window.removeEventListener(\"blur\", handleBlur);\n\n            window.removeEventListener(\"keyup\", handleMods);\n            window.removeEventListener(\"keydown\", handleMods);\n            window.removeEventListener(\"keypress\", handleMods);\n        }\n    }\n\n    // Attach listeners\n    attachListeners();\n\n    const result: {\n        x: number, y: number, element: any,\n        buttons: any\n    } = {\n        element\n    } as any;\n\n    Object.defineProperties(result, {\n        enabled: {\n            get() { return attached; },\n            set(f)\n            {\n                if (f)\n                {\n                    attachListeners();\n                }\n                else\n                {\n                    detachListeners();\n                }\n            },\n            enumerable: true\n        },\n        buttons: {\n            get() { return buttonState; },\n            enumerable: true\n        },\n        x: {\n            get() { return x; },\n            enumerable: true\n        },\n        y: {\n            get() { return y; },\n            enumerable: true\n        },\n        mods: {\n            get() { return mods; },\n            enumerable: true\n        }\n    });\n\n    return result;\n}\n","// @see https://github.com/mattdesl/parse-unit\n\nexport function parseUnit(str, out?)\n{\n    if (!out)\n    { out = [0, \"\"]; }\n\n    str = String(str);\n    const num = parseFloat(str);\n    out[0] = num;\n    out[1] = str.match(/[\\d.\\-\\+]*\\s*(.*)/)[1] || \"\";\n\n    return out;\n}\n","// @see https://github.com/mikolalysenko/to-px.git\n\nimport { parseUnit } from \"./parse-unit\";\n\nconst PIXELS_PER_INCH = 96;\n\nconst defaults = {\n    ch: 8,\n    ex: 7.15625,\n    em: 16,\n    rem: 16,\n    in: PIXELS_PER_INCH,\n    cm: PIXELS_PER_INCH / 2.54,\n    mm: PIXELS_PER_INCH / 25.4,\n    pt: PIXELS_PER_INCH / 72,\n    pc: PIXELS_PER_INCH / 6,\n    px: 1\n};\n\nexport function toPX(str)\n{\n    if (!str) return null;\n\n    if (defaults[str]) return defaults[str];\n\n    // detect number of units\n    const parts = parseUnit(str);\n    if (!isNaN(parts[0]) && parts[1])\n    {\n        const px = toPX(parts[1]);\n\n        return typeof px === \"number\" ? parts[0] * px : null;\n    }\n\n    return null;\n}\n","// @see https://github.com/mikolalysenko/mouse-wheel.git\n\nimport { toPX } from \"./to-px\";\n\nexport function mouseWheelListen(element, callback?, noScroll?)\n{\n    if (typeof element === \"function\")\n    {\n        noScroll = !!callback;\n        callback = element;\n        element = window;\n    }\n\n    const lineHeight = toPX(\"ex\");\n    const listener = (ev) =>\n    {\n        if (noScroll)\n        {\n            ev.preventDefault();\n        }\n        let dx = ev.deltaX || 0;\n        let dy = ev.deltaY || 0;\n        let dz = ev.deltaZ || 0;\n        const mode = ev.deltaMode;\n        let scale = 1;\n        switch (mode)\n        {\n            case 1:\n                scale = lineHeight;\n                break;\n            case 2:\n                scale = window.innerHeight;\n                break;\n        }\n        dx *= scale;\n        dy *= scale;\n        dz *= scale;\n        if (dx || dy || dz)\n        {\n            return callback(dx, dy, dz, ev);\n        }\n    };\n    element.addEventListener(\"wheel\", listener);\n\n    return listener;\n}\n","import { RenderObject } from \"@feng3d/render-api\";\n\nimport { mouseListen as mouseChange } from \"../mikolalysenko/mouse-change\";\nimport { mouseWheelListen as mouseWheel } from \"../mikolalysenko/mouse-wheel\";\nimport { identity, lookAt, perspective } from \"../stackgl/gl-mat4\";\n\nexport function createCamera(props)\n{\n  const cameraState = {\n    view: identity(new Float32Array(16)),\n    projection: identity(new Float32Array(16)),\n    center: new Float32Array(props.center || 3),\n    theta: props.theta || 0,\n    phi: props.phi || 0,\n    distance: Math.log(props.distance || 10.0),\n    eye: new Float32Array(3),\n    up: new Float32Array(props.up || [0, 1, 0])\n  };\n\n  const right = new Float32Array([1, 0, 0]);\n  const front = new Float32Array([0, 0, 1]);\n\n  const minDistance = Math.log(\"minDistance\" in props ? props.minDistance : 0.1);\n  const maxDistance = Math.log(\"maxDistance\" in props ? props.maxDistance : 1000);\n\n  let dtheta = 0;\n  let dphi = 0;\n  let ddistance = 0;\n\n  let prevX = 0;\n  let prevY = 0;\n  mouseChange(function (buttons, x, y)\n  {\n    if (buttons & 1)\n    {\n      const dx = (x - prevX) / window.innerWidth;\n      const dy = (y - prevY) / window.innerHeight;\n      const w = Math.max(cameraState.distance, 0.5);\n\n      dtheta += w * dx;\n      dphi += w * dy;\n    }\n    prevX = x;\n    prevY = y;\n  });\n\n  mouseWheel(function (dx, dy)\n  {\n    ddistance += dy / window.innerHeight;\n  });\n\n  function damp(x)\n  {\n    const xd = x * 0.9;\n    if (Math.abs(xd) < 0.1)\n    {\n      return 0;\n    }\n\n    return xd;\n  }\n\n  function clamp(x, lo, hi)\n  {\n    return Math.min(Math.max(x, lo), hi);\n  }\n\n  function updateCamera()\n  {\n    const center = cameraState.center;\n    const eye = cameraState.eye;\n    const up = cameraState.up;\n\n    cameraState.theta += dtheta;\n    cameraState.phi = clamp(\n      cameraState.phi + dphi,\n      -Math.PI / 2.0,\n      Math.PI / 2.0);\n    cameraState.distance = clamp(\n      cameraState.distance + ddistance,\n      minDistance,\n      maxDistance);\n\n    dtheta = damp(dtheta);\n    dphi = damp(dphi);\n    ddistance = damp(ddistance);\n\n    const theta = cameraState.theta;\n    const phi = cameraState.phi;\n    const r = Math.exp(cameraState.distance);\n\n    const vf = r * Math.sin(theta) * Math.cos(phi);\n    const vr = r * Math.cos(theta) * Math.cos(phi);\n    const vu = r * Math.sin(phi);\n\n    for (let i = 0; i < 3; ++i)\n    {\n      eye[i] = center[i] + vf * front[i] + vr * right[i] + vu * up[i];\n    }\n\n    lookAt(cameraState.view, eye, center, up);\n  }\n\n  const injectContext = (renderObject: RenderObject, viewportWidth: number, viewportHeight: number) =>\n  {\n    Object.keys(cameraState).forEach(function (name)\n    {\n      renderObject.bindingResources[name] = setupCamera[name];\n    });\n\n    renderObject.bindingResources[\"projection\"] = perspective(cameraState.projection,\n      Math.PI / 4.0,\n      viewportWidth / viewportHeight,\n      0.01,\n      1000.0);\n  };\n\n  function setupCamera(renderObject: RenderObject, viewportWidth: number, viewportHeight: number)\n  {\n    updateCamera();\n    injectContext(renderObject, viewportWidth, viewportHeight);\n  }\n\n  Object.keys(cameraState).forEach(function (name)\n  {\n    setupCamera[name] = cameraState[name];\n  });\n\n  return setupCamera;\n}\n","import { RenderObject } from \"@feng3d/render-api\";\nimport { WebGL } from \"@feng3d/webgl\";\n\nimport { angleNormals } from \"./mikolalysenko/angle-normals\";\nimport * as bunny from \"./mikolalysenko/bunny\";\nimport { createCamera } from \"./util/camera\";\n\nconst canvas = document.createElement(\"canvas\");\ncanvas.id = \"glcanvas\";\ncanvas.width = window.innerWidth;\ncanvas.height = window.innerHeight;\ndocument.body.appendChild(canvas);\n\nconst webgl = new WebGL({ canvasId: \"glcanvas\", webGLContextAttributes: { antialias: true } });\n\nconst camera = createCamera({\n    center: [0, 2.5, 0]\n});\n\nconst positions = bunny.positions.flat();\nconst indices = bunny.cells.flat();\nconst normals = angleNormals(bunny.cells, bunny.positions).flat();\n\nconst renderObject: RenderObject = {\n    geometry: {\n        vertices: {\n            position: { data: new Float32Array(positions), format: \"float32x3\" },\n            normal: { data: new Float32Array(normals), format: \"float32x3\" },\n        },\n        indices: new Uint16Array(indices),\n        draw: { __type__: \"DrawIndexed\", indexCount: indices.length },\n    },\n    bindingResources: {},\n    pipeline: {\n        vertex: {\n            code: `precision mediump float;\n        uniform mat4 projection, view;\n        attribute vec3 position, normal;\n        varying vec3 vnormal;\n        void main () {\n          vnormal = normal;\n          gl_Position = projection * view * vec4(position, 1.0);\n        }` },\n        fragment: {\n            code: `precision mediump float;\n        varying vec3 vnormal;\n        void main () {\n          gl_FragColor = vec4(abs(vnormal), 1.0);\n        }`,\n            targets: [{ blend: {} }],\n        },\n        depthStencil: { depthWriteEnabled: true },\n    }\n};\n\nfunction draw()\n{\n    canvas.width = canvas.clientWidth;\n    canvas.height = canvas.clientHeight;\n\n    camera(renderObject, canvas.width, canvas.height);\n\n    webgl.submit({\n        commandEncoders: [{\n            passEncoders: [\n                {\n                    descriptor: { colorAttachments: [{ clearValue: [0, 0, 0, 1] }] },\n                    renderObjects: [renderObject]\n                }\n            ]\n        }]\n    });\n\n    requestAnimationFrame(draw);\n}\ndraw();\n"],"names":["hypot","x","y","z","weight","s","r","a","mulAdd","dest","angleNormals","cells","positions","numVerts","numCells","normals","i","cell","b","c","abx","aby","abz","ab","bcx","bcy","bcz","bc","cax","cay","caz","ca","nx","ny","nz","nl","n","l","mouseButtons","ev","buttons","mouseElement","mouseRelativeX","bounds","mouseRelativeY","mouseListen","element","callback","buttonState","mods","attached","updateMods","changed","handleEvent","nextButtons","nextX","mouse.x","nextY","mouse.y","clearState","handleBlur","handleMods","handleMouseMove","mouse.buttons","handleMouseDown","handleMouseUp","attachListeners","detachListeners","result","f","parseUnit","str","out","num","PIXELS_PER_INCH","defaults","toPX","parts","px","mouseWheelListen","noScroll","lineHeight","listener","dx","dy","dz","mode","scale","createCamera","props","cameraState","identity","right","front","minDistance","maxDistance","dtheta","dphi","ddistance","prevX","prevY","mouseChange","w","mouseWheel","damp","xd","clamp","lo","hi","updateCamera","center","eye","up","theta","phi","vf","vr","vu","lookAt","injectContext","renderObject","viewportWidth","viewportHeight","name","setupCamera","perspective","canvas","webgl","WebGL","camera","bunny.positions","indices","bunny.cells","draw"],"mappings":"4MAAA,SAASA,EAAMC,EAAGC,EAAGC,EACrB,CACI,OAAO,KAAK,KAAK,KAAK,IAAIF,EAAG,CAAC,EAAI,KAAK,IAAIC,EAAG,CAAC,EAAI,KAAK,IAAIC,EAAG,CAAC,CAAC,CACrE,CAEA,SAASC,EAAOC,EAAGC,EAAGC,EACtB,CACI,OAAO,KAAK,MAAMD,EAAID,EAAIE,CAAE,CAChC,CAEA,SAASC,EAAOC,EAAMJ,EAAGJ,EAAGC,EAAGC,EAC/B,CACSM,EAAA,CAAC,GAAKJ,EAAIJ,EACVQ,EAAA,CAAC,GAAKJ,EAAIH,EACVO,EAAA,CAAC,GAAKJ,EAAIF,CACnB,CAEgB,SAAAO,EAAaC,EAAmBC,EAChD,CACI,MAAMC,EAAWD,EAAU,OACrBE,EAAWH,EAAM,OAGjBI,EAAsB,IAAI,MAAMF,CAAQ,EAC9C,QAASG,EAAI,EAAGA,EAAIH,EAAU,EAAEG,EAE5BD,EAAQC,CAAC,EAAI,CAAC,EAAG,EAAG,CAAC,EAIzB,QAASA,EAAI,EAAGA,EAAIF,EAAU,EAAEE,EAChC,CACU,MAAAC,EAAON,EAAMK,CAAC,EACdT,EAAIK,EAAUK,EAAK,CAAC,CAAC,EACrBC,EAAIN,EAAUK,EAAK,CAAC,CAAC,EACrBE,EAAIP,EAAUK,EAAK,CAAC,CAAC,EAErBG,EAAMb,EAAE,CAAC,EAAIW,EAAE,CAAC,EAChBG,EAAMd,EAAE,CAAC,EAAIW,EAAE,CAAC,EAChBI,EAAMf,EAAE,CAAC,EAAIW,EAAE,CAAC,EAChBK,EAAKvB,EAAMoB,EAAKC,EAAKC,CAAG,EAExBE,EAAMN,EAAE,CAAC,EAAIC,EAAE,CAAC,EAChBM,EAAMP,EAAE,CAAC,EAAIC,EAAE,CAAC,EAChBO,EAAMR,EAAE,CAAC,EAAIC,EAAE,CAAC,EAChBQ,EAAK3B,EAAMwB,EAAKC,EAAKC,CAAG,EAExBE,EAAMT,EAAE,CAAC,EAAIZ,EAAE,CAAC,EAChBsB,EAAMV,EAAE,CAAC,EAAIZ,EAAE,CAAC,EAChBuB,EAAMX,EAAE,CAAC,EAAIZ,EAAE,CAAC,EAChBwB,EAAK/B,EAAM4B,EAAKC,EAAKC,CAAG,EAE9B,GAAI,KAAK,IAAIP,EAAII,EAAII,CAAE,EAAI,KAEvB,SAGE,MAAA1B,EAAI,IAAOkB,EAAKI,EAAKI,GACrBzB,EAAI,KAAK,MAAMD,EAAIkB,IAAOlB,EAAIsB,IAAOtB,EAAI0B,GAAM1B,CAAC,EAElD,IAAA2B,EAAKX,EAAMK,EAAMJ,EAAMG,EACvBQ,EAAKX,EAAME,EAAMJ,EAAMM,EACvBQ,EAAKd,EAAMK,EAAMJ,EAAMG,EAC3B,MAAMW,EAAKnC,EAAMgC,EAAIC,EAAIC,CAAE,EACrBF,GAAAG,EACAF,GAAAE,EACAD,GAAAC,EAEN3B,EAAOO,EAAQE,EAAK,CAAC,CAAC,EAAGb,EAAOC,EAAGC,EAAGqB,CAAE,EAAGK,EAAIC,EAAIC,CAAE,EACrD1B,EAAOO,EAAQE,EAAK,CAAC,CAAC,EAAGb,EAAOC,EAAGC,EAAGyB,CAAE,EAAGC,EAAIC,EAAIC,CAAE,EACrD1B,EAAOO,EAAQE,EAAK,CAAC,CAAC,EAAGb,EAAOC,EAAGC,EAAGiB,CAAE,EAAGS,EAAIC,EAAIC,CAAE,CACzD,CAGA,QAASlB,EAAI,EAAGA,EAAIH,EAAU,EAAEG,EAChC,CACU,MAAAoB,EAAIrB,EAAQC,CAAC,EACbqB,EAAI,KAAK,KACX,KAAK,IAAID,EAAE,CAAC,EAAG,CAAC,EACd,KAAK,IAAIA,EAAE,CAAC,EAAG,CAAC,EAChB,KAAK,IAAIA,EAAE,CAAC,EAAG,CAAC,CAAA,EACtB,GAAIC,EAAI,KACR,CACID,EAAE,CAAC,EAAI,EACPA,EAAE,CAAC,EAAI,EACPA,EAAE,CAAC,EAAI,EACP,QACJ,CACAA,EAAE,CAAC,GAAKC,EACRD,EAAE,CAAC,GAAKC,EACRD,EAAE,CAAC,GAAKC,CACZ,CAEO,OAAAtB,CACX,CC5FA,SAASuB,EAAaC,EACtB,CACQ,GAAA,OAAOA,GAAO,SAClB,CACI,GAAI,YAAaA,EAEb,OAAOA,EAAG,QACd,GACS,UAAWA,EACpB,CACI,MAAMrB,EAAIqB,EAAG,MACb,GAAIrB,IAAM,EAEC,MAAA,GACX,GACSA,IAAM,EAEJ,MAAA,GACX,GACSA,EAAI,EAET,MAAO,IAAMA,EAAI,CACrB,SAEK,WAAYqB,EACrB,CACI,MAAMrB,EAAIqB,EAAG,OACb,GAAIrB,IAAM,EAEC,MAAA,GACX,GACSA,IAAM,EAEJ,MAAA,GACX,GACSA,GAAK,EAEV,MAAO,IAAKA,CAEpB,CACJ,CAEO,MAAA,EACX,CACO,MAAMsB,EAAUF,EAEvB,SAASG,EAAaF,EACtB,CACW,OAAAA,EAAG,QAAUA,EAAG,YAAc,MACzC,CAGA,SAASG,EAAeH,EACxB,CACQ,GAAA,OAAOA,GAAO,SAClB,CACI,GAAI,YAAaA,EAEb,OAAOA,EAAG,QAGR,MAAAI,EADSF,EAAaF,CAAE,EACR,wBAEf,OAAAA,EAAG,QAAUI,EAAO,IAC/B,CAEO,MAAA,EACX,CACO,MAAM1C,EAAIyC,EAEjB,SAASE,EAAeL,EACxB,CACQ,GAAA,OAAOA,GAAO,SAClB,CACI,GAAI,YAAaA,EAEb,OAAOA,EAAG,QAGR,MAAAI,EADSF,EAAaF,CAAE,EACR,wBAEf,OAAAA,EAAG,QAAUI,EAAO,GAC/B,CAEO,MAAA,EACX,CACO,MAAMzC,EAAI0C,ECpFD,SAAAC,EAAYC,EAAUC,EACtC,CACSA,IAEUA,EAAAD,EACDA,EAAA,QAGd,IAAIE,EAAc,EACd/C,EAAI,EACJC,EAAI,EACR,MAAM+C,EAAO,CACT,MAAO,GACP,IAAK,GACL,QAAS,GACT,KAAM,EAAA,EAEV,IAAIC,EAAW,GAEf,SAASC,EAAWZ,EACpB,CACI,IAAIa,EAAU,GACd,MAAI,WAAYb,IAEFa,EAAAA,GAAWb,EAAG,SAAWU,EAAK,IACnCA,EAAA,IAAM,CAAC,CAACV,EAAG,QAEhB,aAAcA,IAEJa,EAAAA,GAAWb,EAAG,WAAaU,EAAK,MACrCA,EAAA,MAAQ,CAAC,CAACV,EAAG,UAElB,YAAaA,IAEHa,EAAAA,GAAWb,EAAG,UAAYU,EAAK,QACpCA,EAAA,QAAU,CAAC,CAACV,EAAG,SAEpB,YAAaA,IAEHa,EAAAA,GAAWb,EAAG,UAAYU,EAAK,KACpCA,EAAA,KAAO,CAAC,CAACV,EAAG,SAGda,CACX,CAES,SAAAC,EAAYC,EAAaf,EAClC,CACU,MAAAgB,EAAQC,EAAQjB,CAAE,EAClBkB,EAAQC,EAAQnB,CAAE,EACpB,YAAaA,IAEbe,EAAcf,EAAG,QAAU,IAE3Be,IAAgBN,GACbO,IAAUtD,GACVwD,IAAUvD,GACViD,EAAWZ,CAAE,KAEhBS,EAAcM,EAAc,EAC5BrD,EAAIsD,GAAS,EACbrD,EAAIuD,GAAS,EACbV,GAAYA,EAASC,EAAa/C,EAAGC,EAAG+C,CAAI,EAEpD,CAEA,SAASU,EAAWpB,EACpB,CACIc,EAAY,EAAGd,CAAE,CACrB,CAEA,SAASqB,GACT,EACQZ,GACG/C,GACAC,GACA+C,EAAK,OACLA,EAAK,KACLA,EAAK,MACLA,EAAK,WAERhD,EAAIC,EAAI,EACM8C,EAAA,EACdC,EAAK,MAAQA,EAAK,IAAMA,EAAK,QAAUA,EAAK,KAAO,GACnDF,GAAYA,EAAS,EAAG,EAAG,EAAGE,CAAI,EAE1C,CAEA,SAASY,EAAWtB,EACpB,CACQY,EAAWZ,CAAE,GAEbQ,GAAYA,EAASC,EAAa/C,EAAGC,EAAG+C,CAAI,CAEpD,CAEA,SAASa,EAAgBvB,EACzB,CACQwB,EAAcxB,CAAE,IAAM,EAEtBc,EAAY,EAAGd,CAAE,EAIjBc,EAAYL,EAAaT,CAAE,CAEnC,CAEA,SAASyB,EAAgBzB,EACzB,CACIc,EAAYL,EAAce,EAAcxB,CAAE,EAAGA,CAAE,CACnD,CAEA,SAAS0B,EAAc1B,EACvB,CACIc,EAAYL,EAAc,CAACe,EAAcxB,CAAE,EAAGA,CAAE,CACpD,CAEA,SAAS2B,GACT,CACQhB,IAIOA,EAAA,GAEHJ,EAAA,iBAAiB,YAAagB,CAAe,EAE7ChB,EAAA,iBAAiB,YAAakB,CAAe,EAE7ClB,EAAA,iBAAiB,UAAWmB,CAAa,EAEzCnB,EAAA,iBAAiB,aAAca,CAAU,EACzCb,EAAA,iBAAiB,aAAca,CAAU,EACzCb,EAAA,iBAAiB,WAAYa,CAAU,EACvCb,EAAA,iBAAiB,YAAaa,CAAU,EAExCb,EAAA,iBAAiB,OAAQc,CAAU,EAEnCd,EAAA,iBAAiB,QAASe,CAAU,EACpCf,EAAA,iBAAiB,UAAWe,CAAU,EACtCf,EAAA,iBAAiB,WAAYe,CAAU,EAE3Cf,IAAY,SAEL,OAAA,iBAAiB,OAAQc,CAAU,EAEnC,OAAA,iBAAiB,QAASC,CAAU,EACpC,OAAA,iBAAiB,UAAWA,CAAU,EACtC,OAAA,iBAAiB,WAAYA,CAAU,GAEtD,CAEA,SAASM,GACT,CACSjB,IAIMA,EAAA,GAEHJ,EAAA,oBAAoB,YAAagB,CAAe,EAEhDhB,EAAA,oBAAoB,YAAakB,CAAe,EAEhDlB,EAAA,oBAAoB,UAAWmB,CAAa,EAE5CnB,EAAA,oBAAoB,aAAca,CAAU,EAC5Cb,EAAA,oBAAoB,aAAca,CAAU,EAC5Cb,EAAA,oBAAoB,WAAYa,CAAU,EAC1Cb,EAAA,oBAAoB,YAAaa,CAAU,EAE3Cb,EAAA,oBAAoB,OAAQc,CAAU,EAEtCd,EAAA,oBAAoB,QAASe,CAAU,EACvCf,EAAA,oBAAoB,UAAWe,CAAU,EACzCf,EAAA,oBAAoB,WAAYe,CAAU,EAE9Cf,IAAY,SAEL,OAAA,oBAAoB,OAAQc,CAAU,EAEtC,OAAA,oBAAoB,QAASC,CAAU,EACvC,OAAA,oBAAoB,UAAWA,CAAU,EACzC,OAAA,oBAAoB,WAAYA,CAAU,GAEzD,CAGgBK,IAEhB,MAAME,EAGF,CACA,QAAAtB,CAAA,EAGJ,cAAO,iBAAiBsB,EAAQ,CAC5B,QAAS,CACL,KAAM,CAAS,OAAAlB,CAAU,EACzB,IAAImB,EACJ,CACQA,EAEgBH,IAIAC,GAExB,EACA,WAAY,EAChB,EACA,QAAS,CACL,KAAM,CAAS,OAAAnB,CAAa,EAC5B,WAAY,EAChB,EACA,EAAG,CACC,KAAM,CAAS,OAAA/C,CAAG,EAClB,WAAY,EAChB,EACA,EAAG,CACC,KAAM,CAAS,OAAAC,CAAG,EAClB,WAAY,EAChB,EACA,KAAM,CACF,KAAM,CAAS,OAAA+C,CAAM,EACrB,WAAY,EAChB,CAAA,CACH,EAEMmB,CACX,CC3OgB,SAAAE,EAAUC,EAAKC,EAC/B,CACSA,IACGA,EAAA,CAAC,EAAG,EAAE,GAEdD,EAAM,OAAOA,CAAG,EACV,MAAAE,EAAM,WAAWF,CAAG,EAC1B,OAAAC,EAAI,CAAC,EAAIC,EACTD,EAAI,CAAC,EAAID,EAAI,MAAM,mBAAmB,EAAE,CAAC,GAAK,GAEvCC,CACX,CCTA,MAAME,EAAkB,GAElBC,EAAW,CACb,GAAI,EACJ,GAAI,QACJ,GAAI,GACJ,IAAK,GACL,GAAID,EACJ,GAAIA,EAAkB,KACtB,GAAIA,EAAkB,KACtB,GAAIA,EAAkB,GACtB,GAAIA,EAAkB,EACtB,GAAI,CACR,EAEO,SAASE,EAAKL,EACrB,CACI,GAAI,CAACA,EAAY,OAAA,KAEjB,GAAII,EAASJ,CAAG,EAAG,OAAOI,EAASJ,CAAG,EAGhC,MAAAM,EAAQP,EAAUC,CAAG,EACvB,GAAA,CAAC,MAAMM,EAAM,CAAC,CAAC,GAAKA,EAAM,CAAC,EAC/B,CACI,MAAMC,EAAKF,EAAKC,EAAM,CAAC,CAAC,EAExB,OAAO,OAAOC,GAAO,SAAWD,EAAM,CAAC,EAAIC,EAAK,IACpD,CAEO,OAAA,IACX,CC/BgB,SAAAC,GAAiBjC,EAASC,EAAWiC,EACrD,CACQ,OAAOlC,GAAY,aAEnBkC,EAAW,CAAC,CAACjC,EACFA,EAAAD,EACDA,EAAA,QAGR,MAAAmC,EAAaL,EAAK,IAAI,EACtBM,EAAY3C,GAClB,CACQyC,GAEAzC,EAAG,eAAe,EAElB,IAAA4C,EAAK5C,EAAG,QAAU,EAClB6C,EAAK7C,EAAG,QAAU,EAClB8C,EAAK9C,EAAG,QAAU,EACtB,MAAM+C,EAAO/C,EAAG,UAChB,IAAIgD,EAAQ,EACZ,OAAQD,EACR,CACI,IAAK,GACOC,EAAAN,EACR,MACJ,IAAK,GACDM,EAAQ,OAAO,YACf,KACR,CAII,GAHEJ,GAAAI,EACAH,GAAAG,EACAF,GAAAE,EACFJ,GAAMC,GAAMC,EAEZ,OAAOtC,EAASoC,EAAIC,EAAIC,EAAI9C,CAAE,CAClC,EAEI,OAAAO,EAAA,iBAAiB,QAASoC,CAAQ,EAEnCA,CACX,CCvCO,SAASM,GAAaC,EAC7B,CACE,MAAMC,EAAc,CAClB,KAAMC,EAAS,IAAI,aAAa,EAAE,CAAC,EACnC,WAAYA,EAAS,IAAI,aAAa,EAAE,CAAC,EACzC,OAAQ,IAAI,aAAaF,EAAM,QAAU,CAAC,EAC1C,MAAOA,EAAM,OAAS,EACtB,IAAKA,EAAM,KAAO,EAClB,SAAU,KAAK,IAAIA,EAAM,UAAY,EAAI,EACzC,IAAK,IAAI,aAAa,CAAC,EACvB,GAAI,IAAI,aAAaA,EAAM,IAAM,CAAC,EAAG,EAAG,CAAC,CAAC,CAAA,EAGtCG,EAAQ,IAAI,aAAa,CAAC,EAAG,EAAG,CAAC,CAAC,EAClCC,EAAQ,IAAI,aAAa,CAAC,EAAG,EAAG,CAAC,CAAC,EAElCC,EAAc,KAAK,IAAI,gBAAiBL,EAAQA,EAAM,YAAc,EAAG,EACvEM,EAAc,KAAK,IAAI,gBAAiBN,EAAQA,EAAM,YAAc,GAAI,EAE9E,IAAIO,EAAS,EACTC,EAAO,EACPC,EAAY,EAEZC,EAAQ,EACRC,EAAQ,EACAC,EAAA,SAAU7D,EAASvC,EAAGC,EAClC,CACE,GAAIsC,EAAU,EACd,CACQ,MAAA2C,GAAMlF,EAAIkG,GAAS,OAAO,WAC1Bf,GAAMlF,EAAIkG,GAAS,OAAO,YAC1BE,EAAI,KAAK,IAAIZ,EAAY,SAAU,EAAG,EAE5CM,GAAUM,EAAInB,EACdc,GAAQK,EAAIlB,CACd,CACQe,EAAAlG,EACAmG,EAAAlG,CAAA,CACT,EAEUqG,GAAA,SAAUpB,EAAIC,EACzB,CACEc,GAAad,EAAK,OAAO,WAAA,CAC1B,EAED,SAASoB,EAAKvG,EACd,CACE,MAAMwG,EAAKxG,EAAI,GACf,OAAI,KAAK,IAAIwG,CAAE,EAAI,GAEV,EAGFA,CACT,CAES,SAAAC,EAAMzG,EAAG0G,EAAIC,EACtB,CACE,OAAO,KAAK,IAAI,KAAK,IAAI3G,EAAG0G,CAAE,EAAGC,CAAE,CACrC,CAEA,SAASC,GACT,CACE,MAAMC,EAASpB,EAAY,OACrBqB,EAAMrB,EAAY,IAClBsB,EAAKtB,EAAY,GAEvBA,EAAY,OAASM,EACrBN,EAAY,IAAMgB,EAChBhB,EAAY,IAAMO,EAClB,CAAC,KAAK,GAAK,EACX,KAAK,GAAK,CAAA,EACZP,EAAY,SAAWgB,EACrBhB,EAAY,SAAWQ,EACvBJ,EACAC,CAAA,EAEFC,EAASQ,EAAKR,CAAM,EACpBC,EAAOO,EAAKP,CAAI,EAChBC,EAAYM,EAAKN,CAAS,EAE1B,MAAMe,EAAQvB,EAAY,MACpBwB,EAAMxB,EAAY,IAClBpF,EAAI,KAAK,IAAIoF,EAAY,QAAQ,EAEjCyB,EAAK7G,EAAI,KAAK,IAAI2G,CAAK,EAAI,KAAK,IAAIC,CAAG,EACvCE,EAAK9G,EAAI,KAAK,IAAI2G,CAAK,EAAI,KAAK,IAAIC,CAAG,EACvCG,EAAK/G,EAAI,KAAK,IAAI4G,CAAG,EAE3B,QAASlG,EAAI,EAAGA,EAAI,EAAG,EAAEA,EAEvB+F,EAAI/F,CAAC,EAAI8F,EAAO9F,CAAC,EAAImG,EAAKtB,EAAM7E,CAAC,EAAIoG,EAAKxB,EAAM5E,CAAC,EAAIqG,EAAKL,EAAGhG,CAAC,EAGhEsG,EAAO5B,EAAY,KAAMqB,EAAKD,EAAQE,CAAE,CAC1C,CAEA,MAAMO,EAAgB,CAACC,EAA4BC,EAAuBC,IAC1E,CACE,OAAO,KAAKhC,CAAW,EAAE,QAAQ,SAAUiC,EAC3C,CACEH,EAAa,iBAAiBG,CAAI,EAAIC,EAAYD,CAAI,CAAA,CACvD,EAEYH,EAAA,iBAAiB,WAAgBK,EAAYnC,EAAY,WACpE,KAAK,GAAK,EACV+B,EAAgBC,EAChB,IACA,GAAA,CAAM,EAGD,SAAAE,EAAYJ,EAA4BC,EAAuBC,EACxE,CACeb,IACCU,EAAAC,EAAcC,EAAeC,CAAc,CAC3D,CAEA,cAAO,KAAKhC,CAAW,EAAE,QAAQ,SAAUiC,EAC3C,CACcC,EAAAD,CAAI,EAAIjC,EAAYiC,CAAI,CAAA,CACrC,EAEMC,CACT,CC1HA,MAAME,EAAS,SAAS,cAAc,QAAQ,EAC9CA,EAAO,GAAK,WACZA,EAAO,MAAQ,OAAO,WACtBA,EAAO,OAAS,OAAO,YACvB,SAAS,KAAK,YAAYA,CAAM,EAEhC,MAAMC,GAAQ,IAAIC,EAAM,CAAE,SAAU,WAAY,uBAAwB,CAAE,UAAW,EAAK,CAAA,CAAG,EAEvFC,GAASzC,GAAa,CACxB,OAAQ,CAAC,EAAG,IAAK,CAAC,CACtB,CAAC,EAEK5E,GAAYsH,EAAgB,OAC5BC,EAAUC,EAAY,OACtBrH,GAAUL,EAAa0H,EAAaF,CAAe,EAAE,KAAK,EAE1DV,EAA6B,CAC/B,SAAU,CACN,SAAU,CACN,SAAU,CAAE,KAAM,IAAI,aAAa5G,EAAS,EAAG,OAAQ,WAAY,EACnE,OAAQ,CAAE,KAAM,IAAI,aAAaG,EAAO,EAAG,OAAQ,WAAY,CACnE,EACA,QAAS,IAAI,YAAYoH,CAAO,EAChC,KAAM,CAAE,SAAU,cAAe,WAAYA,EAAQ,MAAO,CAChE,EACA,iBAAkB,CAAC,EACnB,SAAU,CACN,OAAQ,CACJ,KAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAOP,EACH,SAAU,CACN,KAAM;AAAA;AAAA;AAAA;AAAA,WAKN,QAAS,CAAC,CAAE,MAAO,CAAA,EAAI,CAC3B,EACA,aAAc,CAAE,kBAAmB,EAAK,CAC5C,CACJ,EAEA,SAASE,GACT,CACIP,EAAO,MAAQA,EAAO,YACtBA,EAAO,OAASA,EAAO,aAEvBG,GAAOT,EAAcM,EAAO,MAAOA,EAAO,MAAM,EAEhDC,GAAM,OAAO,CACT,gBAAiB,CAAC,CACd,aAAc,CACV,CACI,WAAY,CAAE,iBAAkB,CAAC,CAAE,WAAY,CAAC,EAAG,EAAG,EAAG,CAAC,CAAA,CAAG,CAAE,EAC/D,cAAe,CAACP,CAAY,CAChC,CACJ,CAAA,CACH,CAAA,CACJ,EAED,sBAAsBa,CAAI,CAC9B,CACAA,EAAK"}