{"version":3,"file":"fbo_rtt_draw_buffers.html-17e138f0.js","sources":["../../../../examples/src/WebGL2Samples/fbo_rtt_draw_buffers.ts"],"sourcesContent":["import { CanvasContext, RenderPass, RenderPassDescriptor, RenderPipeline, Sampler, Texture, VertexAttributes } from \"@feng3d/render-api\";\nimport { WebGL } from \"@feng3d/webgl\";\nimport { getShaderSource } from \"./utility\";\n\nconst canvas = document.createElement(\"canvas\");\ncanvas.id = \"glcanvas\";\ncanvas.width = window.innerWidth;\ncanvas.height = window.innerHeight;\ndocument.body.appendChild(canvas);\n\nconst renderingContext: CanvasContext = { canvasId: \"glcanvas\" };\nconst webgl = new WebGL(renderingContext);\n\nconst windowSize = {\n    x: canvas.width,\n    y: canvas.height\n};\n\n// -- Initialize program\n\n// Draw buffer shaders\nconst drawBufferProgram: RenderPipeline = {\n    vertex: { code: getShaderSource(\"vs-draw-buffer\") },\n    fragment: { code: getShaderSource(\"fs-draw-buffer\") },\n};\n\n// Draw shaders\nconst drawProgram: RenderPipeline = {\n    vertex: { code: getShaderSource(\"vs-draw\") },\n    fragment: { code: getShaderSource(\"fs-draw\") },\n};\n\n// -- Initialize buffer\n\nconst triPositions = new Float32Array([\n    -0.5, -0.5, -1.0,\n    0.5, -0.5, -1.0,\n    0.0, 0.5, 1.0\n]);\n\nconst quadPositions = new Float32Array([\n    -1.0, -1.0,\n    1.0, -1.0,\n    1.0, 1.0,\n    1.0, 1.0,\n    -1.0, 1.0,\n    -1.0, -1.0\n]);\n\nconst quadTexcoords = new Float32Array([\n    0.0, 0.0,\n    1.0, 0.0,\n    1.0, 1.0,\n    1.0, 1.0,\n    0.0, 1.0,\n    0.0, 0.0\n]);\n\n// -- Initialize vertex array\n\nconst triVertexArray: { vertices?: VertexAttributes } = {\n    vertices: {\n        position: { data: triPositions, format: \"float32x3\" }\n    }\n};\n\nconst quadVertexArray: { vertices?: VertexAttributes } = {\n    vertices: {\n        position: { data: quadPositions, format: \"float32x2\" },\n        textureCoordinates: { data: quadTexcoords, format: \"float32x2\" },\n    }\n};\n\n// -- Initialize texture targets\n\nconst color1Texture: Texture = {\n    format: \"rgba8unorm\",\n    size: [windowSize.x, windowSize.y],\n};\nconst color1Sampler: Sampler = { addressModeU: \"clamp-to-edge\", addressModeV: \"clamp-to-edge\", minFilter: \"nearest\", magFilter: \"nearest\" };\n\nconst color2Texture: Texture = {\n    format: \"rgba8unorm\",\n    size: [windowSize.x, windowSize.y],\n};\nconst color2Sampler: Sampler = { addressModeU: \"clamp-to-edge\", addressModeV: \"clamp-to-edge\", minFilter: \"nearest\", magFilter: \"nearest\" };\n\n// -- Initialize frame buffer\n\nconst frameBuffer: RenderPassDescriptor = {\n    colorAttachments: [\n        { view: { texture: color1Texture, baseMipLevel: 0 } },\n        { view: { texture: color2Texture, baseMipLevel: 0 } },\n    ],\n};\n\n// -- Render\n\nconst renderPass: RenderPass = {\n    descriptor: frameBuffer,\n    renderObjects: [{\n        pipeline: drawBufferProgram,\n        geometry: {\n            primitive: { topology: \"triangle-list\" },\n            vertices: triVertexArray.vertices,\n            draw: { __type__: \"DrawVertex\", vertexCount: 3 },\n        }\n    }],\n};\n\n// Pass 2: Draw to screen\nconst renderPass2: RenderPass = {\n    descriptor: { colorAttachments: [{ clearValue: [0.0, 0.0, 0.0, 1.0], loadOp: \"clear\" }] },\n    renderObjects: [{\n        pipeline: drawProgram,\n        bindingResources: {\n            color1Map: { texture: color1Texture, sampler: color1Sampler },\n            color2Map: { texture: color2Texture, sampler: color2Sampler },\n        },\n        geometry: {\n            primitive: { topology: \"triangle-list\" },\n            vertices: quadVertexArray.vertices,\n            draw: { __type__: \"DrawVertex\", vertexCount: 6 },\n        }\n    }],\n};\n\nwebgl.submit({ commandEncoders: [{ passEncoders: [renderPass, renderPass2] }] });\n\n// Clean up\nwebgl.deleteFramebuffer(frameBuffer);\nwebgl.deleteTexture(color1Texture);\nwebgl.deleteTexture(color2Texture);\nwebgl.deleteProgram(drawBufferProgram);\nwebgl.deleteProgram(drawProgram);\n\n"],"names":["canvas","renderingContext","webgl","WebGL","windowSize","drawBufferProgram","getShaderSource","drawProgram","triPositions","quadPositions","quadTexcoords","triVertexArray","quadVertexArray","color1Texture","color1Sampler","color2Texture","color2Sampler","frameBuffer","renderPass","renderPass2"],"mappings":"2IAIA,MAAMA,EAAS,SAAS,cAAc,QAAQ,EAC9CA,EAAO,GAAK,WACZA,EAAO,MAAQ,OAAO,WACtBA,EAAO,OAAS,OAAO,YACvB,SAAS,KAAK,YAAYA,CAAM,EAEhC,MAAMC,EAAkC,CAAE,SAAU,YAC9CC,EAAQ,IAAIC,EAAMF,CAAgB,EAElCG,EAAa,CACf,EAAGJ,EAAO,MACV,EAAGA,EAAO,MACd,EAKMK,EAAoC,CACtC,OAAQ,CAAE,KAAMC,EAAgB,gBAAgB,CAAE,EAClD,SAAU,CAAE,KAAMA,EAAgB,gBAAgB,CAAE,CACxD,EAGMC,EAA8B,CAChC,OAAQ,CAAE,KAAMD,EAAgB,SAAS,CAAE,EAC3C,SAAU,CAAE,KAAMA,EAAgB,SAAS,CAAE,CACjD,EAIME,EAAe,IAAI,aAAa,CAClC,IAAM,IAAM,GACZ,GAAK,IAAM,GACX,EAAK,GAAK,CACd,CAAC,EAEKC,EAAgB,IAAI,aAAa,CACnC,GAAM,GACN,EAAK,GACL,EAAK,EACL,EAAK,EACL,GAAM,EACN,GAAM,EACV,CAAC,EAEKC,EAAgB,IAAI,aAAa,CACnC,EAAK,EACL,EAAK,EACL,EAAK,EACL,EAAK,EACL,EAAK,EACL,EAAK,CACT,CAAC,EAIKC,EAAkD,CACpD,SAAU,CACN,SAAU,CAAE,KAAMH,EAAc,OAAQ,WAAY,CACxD,CACJ,EAEMI,EAAmD,CACrD,SAAU,CACN,SAAU,CAAE,KAAMH,EAAe,OAAQ,WAAY,EACrD,mBAAoB,CAAE,KAAMC,EAAe,OAAQ,WAAY,CACnE,CACJ,EAIMG,EAAyB,CAC3B,OAAQ,aACR,KAAM,CAACT,EAAW,EAAGA,EAAW,CAAC,CACrC,EACMU,EAAyB,CAAE,aAAc,gBAAiB,aAAc,gBAAiB,UAAW,UAAW,UAAW,WAE1HC,EAAyB,CAC3B,OAAQ,aACR,KAAM,CAACX,EAAW,EAAGA,EAAW,CAAC,CACrC,EACMY,EAAyB,CAAE,aAAc,gBAAiB,aAAc,gBAAiB,UAAW,UAAW,UAAW,WAI1HC,EAAoC,CACtC,iBAAkB,CACd,CAAE,KAAM,CAAE,QAASJ,EAAe,aAAc,EAAI,EACpD,CAAE,KAAM,CAAE,QAASE,EAAe,aAAc,EAAI,CACxD,CACJ,EAIMG,EAAyB,CAC3B,WAAYD,EACZ,cAAe,CAAC,CACZ,SAAUZ,EACV,SAAU,CACN,UAAW,CAAE,SAAU,eAAgB,EACvC,SAAUM,EAAe,SACzB,KAAM,CAAE,SAAU,aAAc,YAAa,CAAE,CACnD,CAAA,CACH,CACL,EAGMQ,EAA0B,CAC5B,WAAY,CAAE,iBAAkB,CAAC,CAAE,WAAY,CAAC,EAAK,EAAK,EAAK,CAAG,EAAG,OAAQ,OAAS,CAAA,CAAE,EACxF,cAAe,CAAC,CACZ,SAAUZ,EACV,iBAAkB,CACd,UAAW,CAAE,QAASM,EAAe,QAASC,CAAc,EAC5D,UAAW,CAAE,QAASC,EAAe,QAASC,CAAc,CAChE,EACA,SAAU,CACN,UAAW,CAAE,SAAU,eAAgB,EACvC,SAAUJ,EAAgB,SAC1B,KAAM,CAAE,SAAU,aAAc,YAAa,CAAE,CACnD,CAAA,CACH,CACL,EAEAV,EAAM,OAAO,CAAE,gBAAiB,CAAC,CAAE,aAAc,CAACgB,EAAYC,CAAW,EAAG,CAAA,CAAG,EAG/EjB,EAAM,kBAAkBe,CAAW,EACnCf,EAAM,cAAcW,CAAa,EACjCX,EAAM,cAAca,CAAa,EACjCb,EAAM,cAAcG,CAAiB,EACrCH,EAAM,cAAcK,CAAW"}