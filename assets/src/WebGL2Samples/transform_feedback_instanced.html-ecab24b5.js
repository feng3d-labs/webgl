import"../../modulepreload-polyfill-3cfb730f.js";import{g as u}from"../../utility-e972c1ee.js";import{r as _}from"../../index-1ea29437.js";import{W as N}from"../../WebGL-b4686ab5.js";(function(){const a=document.createElement("canvas");a.id="glcanvas",a.width=Math.min(window.innerWidth,window.innerHeight),a.height=a.width,document.body.appendChild(a);const b={canvasId:"glcanvas",webGLcontextId:"webgl2",webGLContextAttributes:{antialias:!1}},x=new N(b);a.addEventListener("webglcontextlost",function(t){t.preventDefault()},!1);const F=0,M=1,w=I(),o=1e3;let n=0;const T=new Float32Array([.015,0,-.01,.01,-.01,-.01]),l=new Float32Array(o*2),v=new Float32Array(Number(o)),c=new Float32Array(o*3);for(let t=0;t<o;++t){const s=t*2,f=t*3;l[s]=Math.random()*2-1,l[s+1]=Math.random()*2-1,v[t]=Math.random()*2*Math.PI,c[f]=Math.random(),c[f+1]=Math.random(),c[f+2]=Math.random()}const i=0,d=1,h=2,g=3,y=4,r=[],O=[],e=new Array(r.length);for(let t=0;t<2;++t)e[t]=new Array(y),e[t][i]=l.slice(),e[t][d]=v.slice(),e[t][h]=T,e[t][g]=c,r[t]=[],r[t][0]={vertices:{a_offset:{data:e[t][i],format:"float32x2"},a_rotation:{data:e[t][d],format:"float32"}}},r[t][1]={vertices:{a_offset:{data:e[t][i],format:"float32x2",stepMode:"instance"},a_rotation:{data:e[t][d],format:"float32",stepMode:"instance"},a_position:{data:e[t][h],format:"float32x2"},a_color:{data:e[t][g],format:"float32x3",stepMode:"instance"}}},O[t]={bindBuffers:[{index:0,data:e[t][i]},{index:1,data:e[t][d]}]};function I(){const t={vertex:{code:u("vs-emit")},transformFeedbackVaryings:{varyings:["v_offset","v_rotation"],bufferMode:"SEPARATE_ATTRIBS"}},s={vertex:{code:u("vs-draw")},fragment:{code:u("fs-draw"),targets:[{blend:{color:{srcFactor:"src-alpha",dstFactor:"one"},alpha:{srcFactor:"src-alpha",dstFactor:"one"}}}]},primitive:{topology:"triangle-list"}};return[t,s]}const m={pipeline:w[F],vertices:null,transformFeedback:null,uniforms:{},draw:{__type__:"DrawVertex",vertexCount:o}},p={viewport:{x:0,y:0,width:a.width,height:a.height-10},pipeline:w[M],bindingResources:{},draw:{__type__:"DrawVertex",vertexCount:3,instanceCount:o}},R={commandEncoders:[{passEncoders:[{__type__:"TransformFeedbackPass",transformFeedbackObjects:[m]},{descriptor:{colorAttachments:[{clearValue:[0,0,0,1],loadOp:"clear"}]},renderPassObjects:[p]}]}]};function C(){const t=Date.now(),s=(n+1)%2;m.vertices=r[n][0].vertices,m.transformFeedback=O[s],_(m.uniforms).u_time=t,n=(n+1)%2}function A(){C(),_(p).vertices=r[n][1].vertices,_(p).indices=r[n][1].indices,x.submit(R),requestAnimationFrame(A)}requestAnimationFrame(A)})();
//# sourceMappingURL=transform_feedback_instanced.html-ecab24b5.js.map
