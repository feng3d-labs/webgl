import"../../modulepreload-polyfill-B5Qt9EMX.js";import{g as p}from"../../utility-BL6jGTgT.js";import{W as N,r as _}from"../../WebGL-lLSa4FVc.js";(function(){const a=document.createElement("canvas");a.id="glcanvas",a.width=Math.min(window.innerWidth,window.innerHeight),a.height=a.width,document.body.appendChild(a);const b={canvasId:"glcanvas",webGLcontextId:"webgl2",webGLContextAttributes:{antialias:!1}},x=new N(b);a.addEventListener("webglcontextlost",function(t){t.preventDefault()},!1);const F=0,M=1,v=I(),n=1e3;let o=0;const T=new Float32Array([.015,0,-.01,.01,-.01,-.01]),l=new Float32Array(n*2),w=new Float32Array(Number(n)),c=new Float32Array(n*3);for(let t=0;t<n;++t){const s=t*2,f=t*3;l[s]=Math.random()*2-1,l[s+1]=Math.random()*2-1,w[t]=Math.random()*2*Math.PI,c[f]=Math.random(),c[f+1]=Math.random(),c[f+2]=Math.random()}const i=0,d=1,h=2,g=3,y=4,r=[],O=[],e=new Array(r.length);for(let t=0;t<2;++t)e[t]=new Array(y),e[t][i]=l.slice(),e[t][d]=w.slice(),e[t][h]=T,e[t][g]=c,r[t]=[],r[t][0]={vertices:{a_offset:{data:e[t][i],format:"float32x2"},a_rotation:{data:e[t][d],format:"float32"}}},r[t][1]={vertices:{a_offset:{data:e[t][i],format:"float32x2",stepMode:"instance"},a_rotation:{data:e[t][d],format:"float32",stepMode:"instance"},a_position:{data:e[t][h],format:"float32x2"},a_color:{data:e[t][g],format:"float32x3",stepMode:"instance"}}},O[t]={bindBuffers:[{index:0,data:e[t][i]},{index:1,data:e[t][d]}]};function I(){const t={vertex:{code:p("vs-emit")},transformFeedbackVaryings:{varyings:["v_offset","v_rotation"],bufferMode:"SEPARATE_ATTRIBS"}},s={vertex:{code:p("vs-draw")},fragment:{code:p("fs-draw"),targets:[{blend:{color:{srcFactor:"src-alpha",dstFactor:"one"},alpha:{srcFactor:"src-alpha",dstFactor:"one"}}}]},primitive:{topology:"triangle-list"}};return[t,s]}const m={pipeline:v[F],vertices:null,transformFeedback:null,uniforms:{},draw:{__type__:"DrawVertex",vertexCount:n}},u={viewport:{x:0,y:0,width:a.width,height:a.height-10},pipeline:v[M],bindingResources:{},draw:{__type__:"DrawVertex",vertexCount:3,instanceCount:n}},R={commandEncoders:[{passEncoders:[{__type__:"TransformFeedbackPass",transformFeedbackObjects:[m]},{descriptor:{colorAttachments:[{clearValue:[0,0,0,1],loadOp:"clear"}]},renderPassObjects:[u]}]}]};function C(){const t=Date.now(),s=(o+1)%2;m.vertices=r[o][0].vertices,m.transformFeedback=O[s],_(m.uniforms).u_time={value:t},o=(o+1)%2}function A(){C(),_(u).vertices=r[o][1].vertices,_(u).indices=r[o][1].indices,x.submit(R),requestAnimationFrame(A)}requestAnimationFrame(A)})();
//# sourceMappingURL=transform_feedback_instanced.html-BPtcyZZa.js.map
