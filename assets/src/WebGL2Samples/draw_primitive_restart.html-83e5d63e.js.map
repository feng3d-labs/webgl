{"version":3,"file":"draw_primitive_restart.html-83e5d63e.js","sources":["../../../../examples/src/WebGL2Samples/draw_primitive_restart.ts"],"sourcesContent":["import { CanvasContext, RenderObject, RenderPipeline, VertexAttributes } from \"@feng3d/render-api\";\nimport { WebGL } from \"@feng3d/webgl\";\nimport { getShaderSource } from \"./utility\";\n\nconst canvas = document.createElement(\"canvas\");\ncanvas.id = \"glcanvas\";\ncanvas.width = Math.min(window.innerWidth, window.innerHeight);\ncanvas.height = canvas.width;\ndocument.body.appendChild(canvas);\n\nconst renderingContext: CanvasContext = { canvasId: \"glcanvas\" };\nconst webgl = new WebGL(renderingContext);\n\n// https://www.khronos.org/registry/webgl/specs/latest/2.0/#5.18\n// WebGL 2.0 behaves as though PRIMITIVE_RESTART_FIXED_INDEX were always enabled.\nconst MAX_UNSIGNED_SHORT = 65535;\n\nconst vertexPosBuffer = new Float32Array([\n    -1.0, -1.0,\n    -1.0, 1.0,\n    1.0, -1.0,\n    1.0, 1.0,\n]);\n\nconst program: RenderPipeline = {\n    vertex: {\n        code: getShaderSource(\"vs\")\n    },\n    fragment: {\n        code: getShaderSource(\"fs\"),\n        targets: [{ blend: {} }],\n    },\n    primitive: { topology: \"triangle-strip\" },\n};\n\nconst indices = new Uint16Array([\n    0, 1, 2, MAX_UNSIGNED_SHORT, 2, 3, 1\n]);\n\nconst vertexArray: { vertices?: VertexAttributes } = {\n    vertices: {\n        pos: { data: vertexPosBuffer, format: \"float32x2\" },\n    },\n};\n\nconst renderObject: RenderObject = {\n    bindingResources: {},\n    vertices: vertexArray.vertices,\n    indices,\n    draw: { __type__: \"DrawIndexed\", indexCount: 7, instanceCount: 2 },\n    pipeline: program,\n};\n\nwebgl.submit({\n    commandEncoders: [{\n        passEncoders: [{\n            descriptor: {\n                colorAttachments: [{\n                    clearValue: [0.0, 0.0, 0.0, 1.0],\n                    loadOp: \"clear\",\n                }],\n            },\n            renderPassObjects: [renderObject]\n        }]\n    }]\n});\n\n// -- Delete WebGL resources\nwebgl.deleteProgram(program);\n"],"names":["canvas","renderingContext","webgl","WebGL","MAX_UNSIGNED_SHORT","vertexPosBuffer","program","getShaderSource","indices","vertexArray","renderObject"],"mappings":"2IAIA,MAAMA,EAAS,SAAS,cAAc,QAAQ,EAC9CA,EAAO,GAAK,WACZA,EAAO,MAAQ,KAAK,IAAI,OAAO,WAAY,OAAO,WAAW,EAC7DA,EAAO,OAASA,EAAO,MACvB,SAAS,KAAK,YAAYA,CAAM,EAEhC,MAAMC,EAAkC,CAAE,SAAU,YAC9CC,EAAQ,IAAIC,EAAMF,CAAgB,EAIlCG,EAAqB,MAErBC,EAAkB,IAAI,aAAa,CACrC,GAAM,GACN,GAAM,EACN,EAAK,GACL,EAAK,CACT,CAAC,EAEKC,EAA0B,CAC5B,OAAQ,CACJ,KAAMC,EAAgB,IAAI,CAC9B,EACA,SAAU,CACN,KAAMA,EAAgB,IAAI,EAC1B,QAAS,CAAC,CAAE,MAAO,CAAA,EAAI,CAC3B,EACA,UAAW,CAAE,SAAU,gBAAiB,CAC5C,EAEMC,EAAU,IAAI,YAAY,CAC5B,EAAG,EAAG,EAAGJ,EAAoB,EAAG,EAAG,CACvC,CAAC,EAEKK,EAA+C,CACjD,SAAU,CACN,IAAK,CAAE,KAAMJ,EAAiB,OAAQ,WAAY,CACtD,CACJ,EAEMK,EAA6B,CAC/B,iBAAkB,CAAC,EACnB,SAAUD,EAAY,SACtB,QAAAD,EACA,KAAM,CAAE,SAAU,cAAe,WAAY,EAAG,cAAe,CAAE,EACjE,SAAUF,CACd,EAEAJ,EAAM,OAAO,CACT,gBAAiB,CAAC,CACd,aAAc,CAAC,CACX,WAAY,CACR,iBAAkB,CAAC,CACf,WAAY,CAAC,EAAK,EAAK,EAAK,CAAG,EAC/B,OAAQ,OAAA,CACX,CACL,EACA,kBAAmB,CAACQ,CAAY,CAAA,CACnC,CAAA,CACJ,CACL,CAAC,EAGDR,EAAM,cAAcI,CAAO"}